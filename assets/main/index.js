System.register("chunks:///_virtual/AnimationHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var n,e,i,s;return{setters:[function(r){n=r.inheritsLoose},function(r){e=r.cclegacy,i=r._decorator,s=r.Component}],execute:function(){var t,o;e._RF.push({},"176299ZXdJILqeT4+svLujj","AnimationHandler",void 0);var a=i.ccclass;i.property,r("AnimationHandler",a("AnimationHandler")(((o=function(r){function e(){return r.apply(this,arguments)||this}return n(e,r),e.setFillProgressBar=function(r){e.fillProgressBar=r},e.callProgress=function(){e.fillProgressBar&&e.fillProgressBar.updateProgressBar()},e}(s)).fillProgressBar=null,o.animTile=[],o.matchAnim=[],o.animList=[],t=o))||t);e._RF.pop()}}}));

System.register("chunks:///_virtual/AssetLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,o,t,s,i,a,n,c,l,p,u;return{setters:[function(r){e=r.applyDecoratedDescriptor,o=r.inheritsLoose,t=r.initializerDefineProperty,s=r.assertThisInitialized},function(r){i=r.cclegacy,a=r._decorator,n=r.ProgressBar,c=r.director,l=r.resources,p=r.SpriteFrame,u=r.Component}],execute:function(){var d,f,g,h,y;i._RF.push({},"876d8QZRoRCaYjzyBTsf+Wl","AssetLoader",void 0);var B=a.ccclass,P=a.property;r("AssetLoader",(d=B("AssetLoader"),f=P(n),d((y=e((h=function(r){function e(){for(var e,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r.call.apply(r,[this].concat(i))||this,t(e,"progressBar",y,s(e)),e}o(e,r);var i=e.prototype;return i.__preload=function(){if(console.log("preloading"),!this.progressBar)throw new Error("ProgressBar is required");c.preloadScene("Prototype"),l.preloadDir("sprite/AllTiles")},i.start=function(){var r=this;l.loadDir("sprite/AllTiles",p,(function(e,o){r.updateProgressBar(e/o)}),(function(e){e?console.error(e):(r.updateProgressBar(1),r.switchToGameScene())}))},i.updateProgressBar=function(r){this.progressBar.progress=r},i.switchToGameScene=function(){c.loadScene("Prototype")},e}(u)).prototype,"progressBar",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=h))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/BackGround.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i,r,o,a,s,c,u,l;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.view,c=e.UITransform,u=e.Size,l=e.Component}],execute:function(){var h,p,d,f,g,z,v;o._RF.push({},"9d56cw8xxFPkbWj8Zus+7CG","BackGround",void 0);var y=a.ccclass,B=a.property;e("BackGround",(h=y("BackGround"),p=B(Boolean),d=B(Boolean),h((z=n((g=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"scaleOnX",z,r(n)),i(n,"scaleOnY",v,r(n)),n}t(n,e);var o=n.prototype;return o.onLoad=function(){this.resizeBackground(),s.on("canvas-resize",this.resizeBackground,this)},o.onDestroy=function(){s.off("canvas-resize",this.resizeBackground,this)},o.resizeBackground=function(){var e=s.getVisibleSize(),n=this.node.getComponent(c);if(n){var t=n.contentSize,i=this.scaleOnX?e.width:t.width,r=this.scaleOnY?e.height:t.height;n.setContentSize(new u(i/this.node.scale.x,r/this.node.scale.y))}},n}(l)).prototype,"scaleOnX",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=n(g.prototype,"scaleOnY",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=g))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/BaseItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,n,e,o,c,r,a,u,l,s,h,m,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){c=t.cclegacy,r=t._decorator,a=t.Sprite,u=t.RichText,l=t.Node,s=t.tween,h=t.Color,m=t.Vec3,f=t.Component}],execute:function(){var p,d,k,y,b,v,B,G,g,I,w,N,q,z,x,L,P;c._RF.push({},"43eactcmDZJ37vn/GEQwiia","BaseItem",void 0);var T=r.ccclass,C=r.property;t("default",(p=T("BaseItem"),d=C(a),k=C(a),y=C(u),b=C(a),v=C(a),B=C(l),G=C(l),p((w=i((I=function(t){function i(){for(var i,n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return i=t.call.apply(t,[this].concat(c))||this,e(i,"icon",w,o(i)),e(i,"BG",N,o(i)),i.mainBG=i.BG,i.mainIcon=i.icon,i.quantity=0,e(i,"quantityText",q,o(i)),i.clicked=!1,i.game=null,e(i,"lockedIcon",z,o(i)),e(i,"lockedBG",x,o(i)),i.locked=!1,e(i,"note",L,o(i)),e(i,"noteLock",P,o(i)),i.currentNote=i.note,i}n(i,t);var c=i.prototype;return c.start=function(){},c.setquantity=function(t){this.quantity=t},c.init=function(){this.textChange(),this.lock(),this.unlock(),0==this.quantity?this.lock():this.unlock()},c.onUse=function(){var t=this;if(!this.locked){var i=[];this.clicked||(this.clicked=!0,i.push(new Promise((function(i){s(t.icon).to(.2,{color:new h(255,255,255,50)}).to(.2,{color:new h(255,255,255,255)},{easing:"bounceOut"}).call((function(){i()})).start()}))),i.push(new Promise((function(i){s(t.icon.node).to(.2,{scale:new m(.5,.5)}).to(.2,{scale:new m(1,1)},{easing:"quadOut"}).call((function(){i()})).start()}))),0!=this.quantity&&Promise.all(i).then((function(){return t.clicked=!1})))}},c.textChange=function(){this.quantityText.string=String(this.quantity)},c.lock=function(){this.locked=!0,this.mainBG&&this.mainIcon&&this.currentNote&&(this.mainBG.node.active=!1,this.mainIcon.node.active=!1,this.currentNote.active=!1),this.mainIcon=this.lockedIcon,this.mainBG=this.lockedBG,this.currentNote=this.noteLock,this.mainBG&&this.mainIcon&&this.currentNote&&(this.mainBG.node.active=!0,this.mainIcon.node.active=!0,this.currentNote.active=!0)},c.unlock=function(){this.locked=!1,this.mainBG&&this.mainIcon&&this.currentNote&&(this.mainBG.node.active=!1,this.mainIcon.node.active=!1,this.currentNote.active=!1),this.mainIcon=this.icon,this.mainBG=this.BG,this.currentNote=this.note,this.mainBG&&this.mainIcon&&this.currentNote&&(this.mainBG.node.active=!0,this.mainIcon.node.active=!0,this.currentNote.active=!0)},i}(f)).prototype,"icon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(I.prototype,"BG",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=i(I.prototype,"quantityText",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(I.prototype,"lockedIcon",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(I.prototype,"lockedBG",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(I.prototype,"note",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=i(I.prototype,"noteLock",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=I))||g));c._RF.pop()}}}));

System.register("chunks:///_virtual/basePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var n,t,e,u;return{setters:[function(o){n=o.inheritsLoose},function(o){t=o.cclegacy,e=o._decorator,u=o.Component}],execute:function(){var p;t._RF.push({},"0755a0dOHNLUotG5cYGTlEV","basePopup",void 0);var c=e.ccclass;o("BasePopup",c("BasePopup")(p=function(o){function t(){return o.apply(this,arguments)||this}n(t,o);var e=t.prototype;return e.onPopupShow=function(o){},e.onPopupHide=function(){},e.onPopupDestroy=function(){},e.closePopup=function(){},t}(u))||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/BaseSubTile.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component}],execute:function(){var u;n._RF.push({},"81dc7NVyPVBPZdBvTIJZutV","BaseSubTile",void 0);var s=i.ccclass;i.property,t("BaseSubTile",s("BaseSubTile")(u=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).used=!1,e.tile=null,e}e(n,t);var i=n.prototype;return i.onDead=function(t,e,n){},i.onResolve=function(){},i.onAttach=function(t){this.tile=t},i.onDetach=function(){this.tile=null},i.isUsed=function(){return this.used},i.reSpawn=function(){this.used=!0},i.kill=function(){this.used=!1},n}(o))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BaseTurn.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"efca6CSsLFI05L/gdQN7SNC","BaseTurn",void 0);n("BaseTurn",function(){function n(n){this.game=void 0,this.game=n}var t=n.prototype;return t.onEnter=function(){},t.onExit=function(){},t.onUpdate=function(){},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/Board.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./global.ts"],(function(t){var e,r,a,o,n,i,l,h,s,u,d;return{setters:[function(t){e=t.inheritsLoose,r=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,o=t._decorator,n=t.Vec2,i=t.Size,l=t.tween,h=t.Tween,s=t.Component},function(t){u=t.default},function(t){d=t.TileType}],execute:function(){var c;a._RF.push({},"52701IqhLtGnIdgKUUwkd2v","Board",void 0);var g=o.ccclass;o.property,t("default",g("Board")(c=function(t){function a(){for(var e,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))||this).board=[],e.game=null,e}e(a,t);var o=a.prototype;return o.match=function(t,e){if(!t.underKill&&!e.underKill)if(this.canMatch(t,e)){var r,a,o=this.getPath(t,e);this.drawPath(o.path,null==(r=this.game)?void 0:r.pathPool),this.putStar(o.path,null==(a=this.game)?void 0:a.starPool),t.onDead(this,!0,e),e.onDead(this,!1,t),t.kill(),e.kill()}else{var n,i;(null==(n=this.game)?void 0:n.tilePool).shake(10,this.game.currentLevel),null==(i=this.game)||i.unChoose()}},o.canMatch=function(t,e){if(t.getTypeID()!==e.getTypeID())return!1;if(t===e)return!1;var r=this.getPath(t,e),a=r.path,o=r.turnNum;return console.log(a),a.length>0&&o<=2},o.getPath=function(t,e){for(var r=t.getCoordinate(),a=e.getCoordinate(),o=this.board.length,i=this.board[0].length,l=[new n(0,1),new n(1,0),new n(0,-1),new n(-1,0)],h=Array.from({length:o},(function(){return Array.from({length:i},(function(){return Array(4).fill(1/0)}))})),s=[],u=0;u<4;u++){var d=l[u],c=r.clone().add(d);this.validate(c,a)&&(h[c.y][c.x][u]=0,s.push({pos:c,dir:d,turn:0,path:[r.clone(),c.clone()]}))}for(;s.length>0;){var g=s.shift(),f=g.pos,v=g.dir,p=g.turn,b=g.path;if(f.equals(a))return{path:b,turnNum:p};for(var m=0;m<4;m++){var y=l[m],P=v.equals(y)?p:p+1;if(!(P>2)){var T=f.clone().add(y);this.validate(T,a)&&(h[T.y][T.x][m]<=P||(h[T.y][T.x][m]=P,s.push({pos:T,dir:y,turn:P,path:[].concat(b,[T.clone()])})))}}}return{path:[],turnNum:0}},o.resetInput=function(){for(var t,e=r(this.board);!(t=e()).done;)for(var a,o=t.value,n=r(o);!(a=n()).done;){a.value.clearOnClickCallbacks()}},o.getBoardSize=function(){return new i(u.TileSize*this.board[0].length,u.TileSize*this.board.length)},o.validate=function(t,e){var r=t.x,a=t.y;if(a<0||a>=this.board.length||r<0||r>=this.board[0].length)return!1;var o=this.board[a][r];return null==o||o.getTypeID()===d.NONE||o===this.board[e.y][e.x]},o.setUpManager=function(t){this.game=t;for(var e,a=r(this.board);!(e=a()).done;)for(var o,n=e.value,i=r(n);!(o=i()).done;){o.value.addOnClickCallback((function(e){return t.choose(e)}))}},o.shake=function(){l(this.node).to},o.create=function(t,e){t.returnAll();var r=e.gridHeight+2,a=e.gridWidth+2;this.board=[];for(var o=0;o<r;o++){this.board[o]=[];for(var i=0;i<a;i++){var l=t.getFirstItem();this.board[o].push(l),null==l||l.setTheme(e.theme);var s=i-1,u=o-1;s>=0&&s<e.gridWidth&&u>=0&&u<e.gridHeight?(null==l||l.setTypeID(e.grid[u][s]),null!=l&&l.node&&h.stopAllByTarget(l.wholeSprite),null==l||l.reScale(e.scale,e.tileSize)):null==l||l.hide(),null==l||l.setCoordinate(new n(i,o)),null==l||l.node.setPosition(0,0),null==l||l.fadeIn(.05*Math.abs(o-e.gridHeight-1)),null==l||l.moveToRealPositionWithPadding(e,!0,.05*Math.abs(o-e.gridHeight-1),"sineOut")}}},o.shuffle=function(){var t;console.log("shuffle");var e=[];null==(t=this.game)||t.stopHint();for(var a,o=r(this.board);!(a=o()).done;)for(var i,l=a.value,h=r(l);!(i=h()).done;){var s=i.value;s.getTypeID()!==d.NONE&&e.push(s)}for(var u=e.length-1;u>0;u--){var c=Math.floor(Math.random()*(u+1)),g=[e[c],e[u]];e[u]=g[0],e[c]=g[1]}for(var f=0,v=0;v<this.board.length;v++)for(var p=0;p<this.board[v].length;p++)if(this.board[v][p].getTypeID()!==d.NONE){var b=e[f++];this.board[v][p]=b,b.setCoordinate(new n(p,v))}for(var m,y=r(this.board);!(m=y()).done;)for(var P,T=m.value,I=r(T);!(P=I()).done;){var w;P.value.moveToRealPositionWithPadding(null==(w=this.game)?void 0:w.currentLevel,!0,0,"expoInOut",1)}},o.addSubTile=function(t,e,r){var a=e.layer.get(r);if(a)for(var o=0;o<e.gridHeight;o++)for(var n=0;n<e.gridWidth;n++){var i;if(1===(null==(i=a[o])?void 0:i[n])){var l=t.getFirstItem(),h=this.board[o+1][n+1];null==h||h.attachSubType(l,r)}}},o.drawPath=function(t,e){for(var r=0;r<t.length-1;r++){var a=t[r],o=this.board[a.y][a.x].node.getPosition().toVec2(),n=t[r+1],i=this.board[n.y][n.x].node.getPosition().toVec2(),l=e.getFirstItem();console.log("from: ",o,"to: ",i),null==l||l.createPath(o,i),console.log("draw path from",a,"to",n)}},o.putStar=function(t,e){for(var r=0;r<t.length;r++){var a=t[r],o=this.board[a.y][a.x].node.getPosition().clone(),n=e.getFirstItem();0!=r&&r!=t.length-1||null==n||n.firstAndLastMatch(),null==n||n.putAt(o)}},a}(s))||c);a._RF.pop()}}}));

System.register("chunks:///_virtual/BombFail.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./UImanager.ts","./BaseTurn.ts"],(function(n){var t,o,e,u,i;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy},function(n){e=n.Popup},function(n){u=n.UImanager},function(n){i=n.BaseTurn}],execute:function(){o._RF.push({},"368e0/pCuFEu7KMmIDlH5yo","BombFail",void 0);n("BombFail",function(n){function o(){return n.apply(this,arguments)||this}t(o,n);var i=o.prototype;return i.onEnter=function(){this.game.turnOffInput(),u.togglePauseButton(!1),this.game.unChoose(),console.log("Fail"),u.showPopup(e.BOOMPOPUP,!0,this.game.currentNumber())},i.onExit=function(){},i.onUpdate=function(){},o}(i));o._RF.pop()}}}));

System.register("chunks:///_virtual/boom-popup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./basePopup.ts"],(function(e){var o,t,r,i,n,l,p,a;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,l=e._decorator,p=e.Label},function(e){a=e.BasePopup}],execute:function(){var c,u,s,f,b;n._RF.push({},"fd57cpWbDNGSJX2WuMUcQu5","boom-popup",void 0);var h=l.ccclass,v=l.property;e("BoomFail",(c=h("BoomFail"),u=v(p),c((b=o((f=function(e){function o(){for(var o,t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return o=e.call.apply(e,[this].concat(n))||this,r(o,"level",b,i(o)),o}return t(o,e),o.prototype.onPopupShow=function(e){this.level.string="LEVEL "+e},o}(a)).prototype,"level",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=f))||s));n._RF.pop()}}}));

System.register("chunks:///_virtual/BoomDefuseItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./BaseItem.ts"],(function(e){var t,i,n,o,r,a,s,l,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Animation,l=e.Vec3},function(e){c=e.SubType},function(e){u=e.default}],execute:function(){var p,f,h,m,y;r._RF.push({},"c5603FwifxAj4rdveJjR9py","BoomDefuseItem",void 0);var d=a.ccclass,v=a.property;e("BoomDefuseItem",(p=d("BoomDefuseItem"),f=v(s),p((y=t((m=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"anim",y,o(t)),t}return i(t,e),t.prototype.onUse=function(){var t=this;if(!this.clicked){for(var i,n,o=[],r=0,a=this.game.board.board;r<a.length;r++){var u=a[r];o.push.apply(o,u.filter((function(e){return e.getSubtileList().has(c.BOOM)})))}if(e.prototype.onUse.call(this),o.length>0&&this.quantity>0)this.quantity-=1,this.textChange(),o[0].detachSubType(c.BOOM),this.anim.node.active=!0,this.anim.node.setWorldPosition(o[0].node.worldPosition),o[0].itemTypeSprite.node.setScale(new l(0)),null==(i=this.anim)||i.play(),null==(n=this.anim)||n.once(s.EventType.FINISHED,(function(){t.anim.node.active=!1,o[0].shrink()}))}},t}(u)).prototype,"anim",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/BoomPool.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,r,s,a,c,d,l,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){a=e.cclegacy,c=e._decorator,d=e.Node,l=e.Animation,h=e.Component}],execute:function(){var u,f,p,m,N,v,y;a._RF.push({},"250acO6i6VM/K3U0sNwRWKT","BoomPool",void 0);var g=c.ccclass,A=c.property;e("BoomPool",(u=g("BoomPool"),f=A(d),p=A(d),u((v=t((N=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,n(t,"firstNode",v,o(t)),n(t,"secondNode",y,o(t)),t.firstAnimationNodes=[],t.secondAnimationNodes=[],t}i(t,e);var a=t.prototype;return a.start=function(){this.initializeNodes(),this.playAnimationSequence()},a.initializeNodes=function(){if(!this.firstNode){var e=this.node.getChildByName("first");if(!e)throw new Error("Child node 'first' not found");this.firstNode=e,this.firstNode.active=!1}if(!this.secondNode){var t=this.node.getChildByName("second");if(!t)throw new Error("Child node 'second' not found");this.secondNode=t,this.secondNode.active=!1}if(this.firstNode){this.firstAnimationNodes=[];for(var i=0;i<this.firstNode.children.length;i++){var n=this.firstNode.children[i];n.getComponent(l)&&this.firstAnimationNodes.push(n)}}if(this.secondNode){this.secondAnimationNodes=[];for(var o=0;o<this.secondNode.children.length;o++){var r=this.secondNode.children[o];r.getComponent(l)&&this.secondAnimationNodes.push(r)}}},a.playAnimationSequence=function(){this.playFirstAnimations().then((function(){}))},a.playFirstAnimations=function(){var e=r(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.firstAnimationNodes.length){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return this.firstNode.active=!0,t=[],this.firstAnimationNodes.forEach((function(e){var i=e.getComponent(l);if(i&&i.clips.length>0){e.active=!0;var n=new Promise((function(e){i.once(l.EventType.FINISHED,(function(){e()})),i.clips[0]?i.play(i.clips[0].name):e()}));t.push(n)}})),e.next=7,Promise.all(t);case 7:this.firstNode.active=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.playSecondAnimations=function(){var e=r(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.secondAnimationNodes.length){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return this.secondNode.active=!0,t=[],this.secondAnimationNodes.forEach((function(e){var i=e.getComponent(l);if(i&&i.clips.length>0){e.active=!0;var n=new Promise((function(e){i.once(l.EventType.FINISHED,(function(){e()})),i.clips[0]&&i.play(i.clips[0].name)}));t.push(n)}})),e.next=7,Promise.all(t);case 7:this.secondNode.active=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(h)).prototype,"firstNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=t(N.prototype,"secondNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=N))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/BoomSubTile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseSubTile.ts","./Countdown.ts"],(function(e){var t,o,n,i,r,l,u,c,a;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,u=e.Sprite},function(e){c=e.BaseSubTile},function(e){a=e.Countdown}],execute:function(){var s,d,h,p,b,f,v,m,w;r._RF.push({},"d5f97QXjRpBK79IAO1Fuh3q","BoomSubTile",void 0);var y=l.ccclass,S=l.property;e("BoomSubTile",(s=y("BoomSubTile"),d=S(u),h=S(u),p=S(a),s((v=t((f=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return(t=e.call.apply(e,[this].concat(r))||this).timer=40,n(t,"coundown",v,i(t)),n(t,"boom",m,i(t)),n(t,"cd",w,i(t)),t}o(t,e);var r=t.prototype;return r.onAttach=function(t){var o;e.prototype.onAttach.call(this,t),null==(o=t.wholeSprite)||o.addChild(this.node),this.coundown.node.active=!0,this.boom.node.active=!0},r.onDead=function(e,t,o){var n,i;null==(n=this.cd)||n.resetCountdown(),null==(i=this.tile)||null==(i=i.wholeSprite)||i.removeChild(this.node),this.coundown.node.active=!1,this.boom.node.active=!1},r.onDetach=function(){var t,o;null==(t=this.cd)||t.resetCountdown(),null==(o=this.tile)||null==(o=o.wholeSprite)||o.removeChild(this.node),this.coundown.node.active=!1,this.boom.node.active=!1,e.prototype.onDetach.call(this)},t}(c)).prototype,"coundown",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(f.prototype,"boom",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(f.prototype,"cd",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=f))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/ButterflySubTile.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"d9d5e9kBRpGp7Fdbtd6hf8P","ButterflySubTile",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/Combo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(t){var i,e,o,n,r,s,l,a,c,h,u;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,l=t.Sprite,a=t.Node,c=t.ParticleSystem2D,h=t.Component},function(t){u=t.default}],execute:function(){var m,b,f,p,d,C,g,v,y;r._RF.push({},"4bebeCsyLJP8KXneWnzpmLu","Combo",void 0);var M=s.ccclass,P=s.property;t("Combo",(m=M("Combo"),b=P(u),f=P(l),p=P(a),m((g=i((C=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return i=t.call.apply(t,[this].concat(r))||this,o(i,"gm",g,n(i)),i.timer=5,i.currentTime=0,i.comboCount=0,o(i,"fill",v,n(i)),i.listSprite={},o(i,"bom",y,n(i)),i.boundOnMatchPair=null,i}e(i,t);var r=i.prototype;return r.start=function(){this.fill&&(this.fill.fillRange=1),this.gm&&(this.boundOnMatchPair=this.onMatchPair.bind(this),this.gm.onMatchPair(this.boundOnMatchPair)),this.node.active=!1;for(var t=2;t<10;t++){var i=this.node.getChildByName(""+t);i&&(this.listSprite[t]=i,i.active=!1)}},r.onDestroy=function(){this.gm&&this.boundOnMatchPair&&this.gm.offMatchPair(this.boundOnMatchPair)},r.update=function(t){this.currentTime+=t;var i=Math.min(this.currentTime/this.timer,1);this.fill&&(this.fill.fillRange=1-i),this.currentTime>this.timer&&(this.node.active=!1,this.comboCount=0,this.hideAllComboNumbers())},r.explode=function(){var t=this.bom?this.bom.getComponent(c):null;t&&t.resetSystem()},r.onMatchPair=function(){this.comboCount++,this.comboCount<2||(this.comboCount>9&&this.comboCount--,this.hideAllComboNumbers(),this.explode(),this.listSprite[this.comboCount]&&(this.listSprite[this.comboCount].active=!0),this.node.active=!0,console.log("Match pair detected! Combo count:",this.comboCount),this.resetCombo())},r.hideAllComboNumbers=function(){for(var t=2;t<10;t++)this.listSprite[t]&&(this.listSprite[t].active=!1)},r.resetCombo=function(){this.currentTime=0,this.fill&&(this.fill.fillRange=1)},i}(h)).prototype,"gm",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=i(C.prototype,"fill",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=i(C.prototype,"bom",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=C))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/Countdown.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i,r,s,a,c,u,l,m,h;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,c=t.Sprite,u=t.find,l=t.Animation,m=t.director,h=t.Component}],execute:function(){var d,p,f,C,v;r._RF.push({},"6fdbaOrIMdOZL1cybBWtB4E","Countdown",void 0);var b=s.ccclass,w=s.property,g=t("GAME_EVENTS",{COUNTDOWN_COMPLETE:"countdown-complete",GAME_OVER:"game-over",LEVEL_WIN:"level-win"});t("Countdown",(d=b("Countdown"),p=w(a),d((v=n((C=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return(n=t.call.apply(t,[this].concat(r))||this).timer=40,n.currentTime=0,o(n,"bom",v,i(n)),n}e(n,t);var r=n.prototype;return r.start=function(){var t=this.node.getComponent(c);t&&(t.fillRange=-1)},r.update=function(t){this.currentTime+=t;var n=Math.min(this.currentTime/this.timer,1),e=this.node.getComponent(c);e&&(e.fillRange=-1+n),this.currentTime>=this.timer&&this.onCountdownComplete()},r.onCountdownComplete=function(){this.enabled=!1,this.playAnimation(),this.resetCountdown(),this.node.parent.active=!1},r.playAnimation=function(){var t=this;this.bom.active=!0;var n=this.bom.parent,e=this.bom.worldPosition,o=u("Canvas")||this.node.scene;this.bom.setParent(o),this.bom.worldPosition=e;var i=this.bom.getComponent(l);i&&(i.play(),console.log(e),i.once(l.EventType.FINISHED,(function(){t.bom.active=!1,t.bom.setParent(n),t.bom.worldPosition=e,t.scheduleOnce((function(){m.emit(g.COUNTDOWN_COMPLETE)}),.5)})))},r.resetCountdown=function(){this.currentTime=0;var t=this.node.getComponent(c);t&&(t.fillRange=-1),this.enabled=!0},r.setCountdownTime=function(t){this.timer=t,this.resetCountdown()},n}(h)).prototype,"bom",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=C))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/EndTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./AnimationHandler.ts","./BaseTurn.ts"],(function(n){var t,i,u,e,o;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy},function(n){u=n.Turn},function(n){e=n.AnimationHandler},function(n){o=n.BaseTurn}],execute:function(){i._RF.push({},"7e7fdGaaZ9HxoPiuFIXzRzg","EndTurn",void 0);n("EndTurn",function(n){function i(){return n.apply(this,arguments)||this}t(i,n);var o=i.prototype;return o.onEnter=function(){var n=this;this.game.isWin()?Promise.all(e.animList).then((function(){n.game.switchTurn(u.WIN)})):this.game.switchTurn(u.START)},o.onExit=function(){},o.onUpdate=function(){},i}(o));i._RF.pop()}}}));

System.register("chunks:///_virtual/fail-popup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./basePopup.ts"],(function(e){var t,i,r,o,n,l,p,a;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){n=e.cclegacy,l=e._decorator,p=e.Label},function(e){a=e.BasePopup}],execute:function(){var c,u,s,f,h;n._RF.push({},"bc1f19BDEdJOLEwAl5uYpN5","fail-popup",void 0);var v=l.ccclass,y=l.property;e("Fail",(c=v("Fail"),u=y(p),c((h=t((f=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return t=e.call.apply(e,[this].concat(n))||this,r(t,"level",h,o(t)),t}return i(t,e),t.prototype.onPopupShow=function(e){this.level.string="LEVEL "+e},t}(a)).prototype,"level",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=f))||s));n._RF.pop()}}}));

System.register("chunks:///_virtual/FailTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./UImanager.ts","./BaseTurn.ts"],(function(n){var t,o,u,e,i;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy},function(n){u=n.Popup},function(n){e=n.UImanager},function(n){i=n.BaseTurn}],execute:function(){o._RF.push({},"61b07ACKfhNEKxk69/h4V23","FailTurn",void 0);n("FailTurn",function(n){function o(){return n.apply(this,arguments)||this}t(o,n);var i=o.prototype;return i.onEnter=function(){this.game.turnOffInput(),e.togglePauseButton(!1),this.game.unChoose(),console.log("Fail"),e.showPopup(u.FAILPOPUP,!0,this.game.currentNumber())},i.onExit=function(){},i.onUpdate=function(){},o}(i));o._RF.pop()}}}));

System.register("chunks:///_virtual/FillProgressBar.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AnimationHandler.ts","./GameManager.ts"],(function(t){var i,e,n,s,r,l,o,a,h,c,u,d,f,g;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){r=t.cclegacy,l=t._decorator,o=t.Sprite,a=t.Label,h=t.UITransform,c=t.tween,u=t.Vec3,d=t.Component},function(t){f=t.AnimationHandler},function(t){g=t.default}],execute:function(){var m,p,v,b,y,z,S,w,F,P,B,x,L,T,R,A,C,N,M;r._RF.push({},"6a5a6pwZ/1Ba7vEmcx463CK","FillProgressBar",void 0);var _=l.ccclass,k=l.property;t("FillProgressBar",(m=_("FillProgressBar"),p=k(g),v=k(o),b=k(o),y=k(o),z=k(o),S=k(o),w=k(o),F=k(a),m((x=i((B=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];return i=t.call.apply(t,[this].concat(r))||this,n(i,"gm",x,s(i)),n(i,"left",L,s(i)),n(i,"right",T,s(i)),n(i,"mid",R,s(i)),n(i,"star",A,s(i)),n(i,"star1",C,s(i)),n(i,"star9",N,s(i)),i.currentStar=null,i.total=0,i.currentTile=0,i.size=0,i.isFirstFill=!0,i.tailNode=null,i.currentActive=0,i.score=0,n(i,"level",M,s(i)),i}e(i,t);var r=i.prototype;return r.start=function(){var t,i,e,n,s,r;(this.left.node.setScale(0,this.left.node.scale.y,this.left.node.z),this.right.node.setScale(0,this.right.node.scale.y,this.right.node.z),this.mid.node.setScale(0,this.mid.node.scale.y,this.mid.node.z),this.tailNode=this.mid.node.getChildByName("taile"),this.size=null!=(t=null==(i=this.node.getChildByName("bar"))||null==(i=i.getComponent(h))?void 0:i.contentSize.x)?t:0,f.setFillProgressBar(this),this.currentStar=null!=(e=null==(n=this.star)?void 0:n.node)?e:null,this.gm)&&(this.total=null!=(s=null==(r=this.gm)||null==(r=r.currentLevel)?void 0:r.getTileNum())?s:0,console.log(this.total),this.level.string="Lvl "+this.gm.currentNumber())},r.onTilesMatched=function(t){console.log("Tiles matched!"),this.updateProgressBar()},r.updateProgressBar=function(){if(!(this.total<=0||this.size<=0)){var t=18/this.total;this.score+=t,this.isFirstFill&&t>0&&(this.showLeft(),this.showRight(),this.isFirstFill=!1),this.updateMidWidth(t),this.checkActive()}},r.checkActive=function(){var t,i,e,n;(this.mid.node.scale.x>=4.5&&(this.star.node.active=!0),this.mid.node.scale.x>=6&&(this.star9.node.active=!0),this.mid.node.scale.x>=7.4&&(this.star1.node.active=!0),this.score>=4.5)&&(this.currentStar=null!=(t=null==(i=this.star9)?void 0:i.node)?t:null);this.score>=6&&(this.currentStar=null!=(e=null==(n=this.star1)?void 0:n.node)?e:null)},r.showLeft=function(){this.left.node.setScale(1,this.left.node.scale.y,this.left.node.scale.z)},r.updateMidWidth=function(t){var i=this;c(this.mid.node).to(.1,{scale:new u(t+this.mid.node.scale.x,this.mid.node.scale.y,this.mid.node.scale.z)},{onUpdate:function(){i.updateRightPosition()}}).start()},r.updateRightPosition=function(){if(this.right&&this.mid){var t=this.mid.node.getComponent(h);if(t){var i=t.contentSize.x*this.mid.node.scale.x,e=t.anchorX,n=this.mid.node.position.x+i*(1-e);this.right.node.setPosition(n,this.right.node.position.y,this.right.node.position.z)}}},r.showRight=function(){this.updateRightPosition(),this.right.node.setScale(1,this.right.node.scale.y,this.right.node.scale.z)},r.resetProgressBar=function(){var t,i;this.currentTile=0,this.isFirstFill=!0,this.left.node.setScale(0,this.left.node.scale.y,this.left.node.z),this.right.node.setScale(0,this.right.node.scale.y,this.right.node.z),this.mid.node.setScale(0,this.mid.node.scale.y,this.mid.node.z),this.star.node.active=!1,this.star1.node.active=!1,this.star9.node.active=!1,this.currentStar=null!=(t=null==(i=this.star)?void 0:i.node)?t:null},r.setTotal=function(t){this.total=t},r.setLv=function(t){this.level.string="Lvl "+t},i}(d)).prototype,"gm",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(B.prototype,"left",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(B.prototype,"right",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(B.prototype,"mid",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(B.prototype,"star",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(B.prototype,"star1",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(B.prototype,"star9",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=i(B.prototype,"level",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=B))||P));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameConfig.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"066a2a7XoVHzJHXDKi1vGjH","GameConfig",void 0);e("default",{TileSize:85});t._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./Board.ts","./LevelLoader.ts","./PathPool.ts","./StarPool.ts","./TilePool.ts","./SubTilePool.ts","./BaseTurn.ts","./EndTurn.ts","./LoadTurn.ts","./MatchTurn.ts","./StartTurn.ts","./Countdown.ts","./BombFail.ts","./FailTurn.ts","./PauseTurn.ts","./WinTurn.ts","./UImanager.ts","./ItemManager.ts"],(function(t){var e,n,i,o,r,s,a,u,l,h,c,f,d,v,T,p,g,P,m,L,C,b,w,I,M,E,O,y,A,N,B,D,S,z;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.assertThisInitialized,o=t.initializerDefineProperty,r=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,a=t._decorator,u=t.director,l=t.find,h=t.Component,c=t.tween,f=t.Color},function(t){d=t.Item,v=t.Turn,T=t.SUBTILE_PATH,p=t.TileType},function(t){g=t.default},function(t){P=t.LevelLoader},function(t){m=t.default},function(t){L=t.default},function(t){C=t.default},function(t){b=t.default},function(t){w=t.BaseTurn},function(t){I=t.EndTurn},function(t){M=t.LoadTurn},function(t){E=t.MatchTurn},function(t){O=t.StartTurn},function(t){y=t.GAME_EVENTS},function(t){A=t.BombFail},function(t){N=t.FailTurn},function(t){B=t.PauseTurn},function(t){D=t.WinTurn},function(t){S=t.UImanager},function(t){z=t.ItemManager}],execute:function(){var U,H,F,_,k,W,x,G,R,V,j,K,Y;s._RF.push({},"d7cedYkadBLIrlmBMhdIKaL","GameManager",void 0);var q=a.ccclass,J=a.property;t("default",(U=q("GameManager"),H=J(C),F=J(Map),_=J(z),k=J(m),W=J(L),U((R=e((G=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this).levelLoader=P.getInstance(),e.currentLevel=void 0,e.time=0,e.ispause=!1,e.turnList=new Map,e.eventTarget=new EventTarget,e.currentTurn=new w(i(e)),e.board=new g,e.matchPair=[],o(e,"tilePool",R,i(e)),o(e,"subtilePool",V,i(e)),o(e,"itemManager",j,i(e)),o(e,"pathPool",K,i(e)),o(e,"starPool",Y,i(e)),e.firstChosen=null,e.secondChosen=null,e.hintPath=[],e.hintPoint=[],e.hintTile=[],e.isgameOver=!1,e}n(e,t);var s=e.prototype;return s.onMatchPair=function(t){this.eventTarget.addEventListener("matchPair",t)},s.offMatchPair=function(t){this.eventTarget.removeEventListener("matchPair",t)},s.emitMatchPair=function(){this.eventTarget.dispatchEvent(new Event("matchPair"))},s.stopHint=function(){var t;if(0!=this.hintPath.length){for(var e,n=r(this.hintPath);!(e=n()).done;){var i=e.value;i.updateVisual(i.node)}for(var o,s=function(){var t=o.value;c(t.circle).to(.2,{color:new f(255,255,255,0)}).call((function(){t.kill(),t.circle.color=new f(255,255,255,255)})).start()},a=r(this.hintPoint);!(o=a()).done;)s();this.hintTile.forEach((function(t){t.onUnHint()})),this.hintPath=[],this.hintPoint=[],this.hintTile=[],null==(t=this.itemManager)||t.unlockItem(d.HINT)}},s.start=function(){var t=this;this.levelLoader.restartLevel().then((function(){var e,n,i;t.currentLevel=t.levelLoader.getCurrentLevel(),null==(e=t.tilePool)||e.initialize(t),null==(n=t.pathPool)||n.initialize(t),null==(i=t.starPool)||i.initialize(t),t.subTilePoolInit(),t.turnInit(),u.on(y.COUNTDOWN_COMPLETE,(function(){t.switchTurn(v.BOOM)}),t)}))},s.subTilePoolInit=function(){for(var t,e=this,n=l(T),i=r(null==n?void 0:n.children);!(t=i()).done;){var o=t.value;this.subtilePool.set(o.name,null==o?void 0:o.getComponent(b))}this.subtilePool.forEach((function(t){t.initialize(e)}))},s.isWin=function(){for(var t,e=r(this.board.board);!(t=e()).done;)for(var n,i=t.value,o=r(i);!(n=o()).done;){if(n.value.getTypeID()!=p.NONE)return!1}return!0},s.turnInit=function(){this.turnList.set(v.START,new O(this)),this.turnList.set(v.MATCH,new E(this)),this.turnList.set(v.END,new I(this)),this.turnList.set(v.LOAD,new M(this)),this.turnList.set(v.FAIL,new N(this)),this.turnList.set(v.WIN,new D(this)),this.turnList.set(v.PAUSE,new B(this)),this.turnList.set(v.BOOM,new A(this)),this.switchTurn(v.LOAD)},s.isSame=function(t,e){return t.getCoordinate().x===e.getCoordinate().x&&t.getCoordinate().y===e.getCoordinate().y},s.sameType=function(t,e){return t.getTypeID()===e.getTypeID()},s.choose=function(t){var e;if(t.getTypeID()!=p.NONE){var n,i,o;if(console.log(t.getCoordinate()),!this.firstChosen||!this.sameType(this.firstChosen,t))return null==(n=this.firstChosen)||n.onUnchoose(),this.firstChosen=t,this.firstChosen.onChoose(),this.stopHint(),void console.log("first: ",this.firstChosen.getCoordinate(),"second: ",null==(i=this.secondChosen)?void 0:i.getCoordinate());if(this.isSame(t,this.firstChosen))return null==(o=this.firstChosen)||o.onChoose(),void this.unChoose();this.secondChosen=t,console.log("first: ",this.firstChosen.getCoordinate(),"second: ",null==(e=this.secondChosen)?void 0:e.getCoordinate()),this.matchPair.push({tile1:this.firstChosen,tile2:this.secondChosen}),this.switchTurn(v.MATCH)}},s.unChoose=function(){var t;null==(t=this.firstChosen)||t.onUnchoose(),this.firstChosen=null,this.secondChosen=null},s.match=function(){var t,e;this.matchPair.length>0&&(null!=(t=this.board)&&t.canMatch(this.matchPair[0].tile1,this.matchPair[0].tile2)&&this.emitMatchPair(),null==(e=this.board)||e.match(this.matchPair[0].tile1,this.matchPair[0].tile2),this.matchPair.shift())},s.currentNumber=function(){return this.levelLoader.getCurrentLevelNumber()},s.poolInit=function(){},s.createBoard=function(t){var e,n,i;this.hintPath=[],this.hintPoint=[],this.hintTile=[],this.subtilePool.forEach((function(t){t.returnAll()})),null==(e=this.tilePool)||e.returnAll(),null==(n=this.itemManager)||n.intialize(this),null==(i=this.board)||i.create(this.tilePool,t);for(var o,s=r(this.subtilePool);!(o=s()).done;){var a,u=o.value;null==(a=this.board)||a.addSubTile(u[1],this.currentLevel,u[0])}this.currentLevel=this.levelLoader.getCurrentLevel()},s.switchTurn=function(t){this.isgameOver||(this.currentTurn&&this.currentTurn.onExit(),this.currentTurn=this.turnList.get(t),this.currentTurn.onEnter())},s.hideItem=function(){this.itemManager.node.active=!1},s.showItem=function(){this.itemManager.node.active=!0},s.turnOnInput=function(){var t;null==(t=this.board)||t.setUpManager(this)},s.restart=function(){var t=this;this.ispause=!1,this.isgameOver=!1,S.togglePauseButton(!0),S.hideAllPopups(),this.levelLoader.checkNeedToChange("failed"),this.levelLoader.restartLevel().then((function(){t.switchTurn(v.LOAD)}))},s.pause=function(){this.ispause=!0,S.hideAllPopups(),S.togglePauseButton(!1),this.switchTurn(v.PAUSE),this.hideItem()},s.unPause=function(){this.ispause=!1,S.hideAllPopups(),S.togglePauseButton(!0),this.turnOnInput(),this.showItem(),this.switchTurn(v.START)},s.moveOn=function(){var t=this;this.isgameOver=!1,this.ispause=!1,S.hideAllPopups(),this.levelLoader.checkNeedToChange("completed"),this.levelLoader.changeLevel().then((function(){t.switchTurn(v.LOAD)}))},s.turnOffInput=function(){var t;null==(t=this.board)||t.resetInput()},s.onDestroy=function(){u.off(y.COUNTDOWN_COMPLETE,(function(){}),this)},e}(h)).prototype,"tilePool",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(G.prototype,"subtilePool",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),j=e(G.prototype,"itemManager",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(G.prototype,"pathPool",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(G.prototype,"starPool",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=G))||x));s._RF.pop()}}}));

System.register("chunks:///_virtual/global.ts",["cc","./GameConfig.ts"],(function(e){var t,i,n,o,T;return{setters:[function(e){t=e.cclegacy,i=e.Vec2,n=e.view,o=e.Vec3},function(e){T=e.default}],execute:function(){e({getComboCount:function(e){return"resources/animation/"+e},getScale:function(){var e=n.getVisibleSize(),t=e.width/720,i=e.width/1280,T=Math.max(t,i);return new o(T,T)},getTilePath:function(e,t){return e==r.ROCKET?"sprite/AllTiles/rocket/spriteFrame":"sprite/AllTiles/"+(t+String(e))+"/spriteFrame"},getTilePosition:function(e,t,n,o,r){var P=o*T.TileSize/2,u=n*T.TileSize/2,E=t*T.TileSize+T.TileSize/2-P,l=-(e*T.TileSize+T.TileSize/2-u);return new i(E,l)},getTilePositionByLevel:function(e,t,n,o){void 0===o&&(o=0);var T=n.tileSize,r=(n.gridWidth+2*o)*T,P=(n.gridHeight+2*o)*T;return new i(e*T+T/2-r/2,-(t*T+T/2-P/2))}}),t._RF.push({},"99b72YbvlRKuojoDTLGRoZ0","global",void 0);e("SubType",function(e){return e.BOOM="BOOM",e.GRAVITY="GRAVITY",e.ROCKET="ROCKET",e.BUTTERFLY="BUTTERFLY",e}({})),e("Turn",function(e){return e[e.LOAD=0]="LOAD",e[e.START=1]="START",e[e.MATCH=2]="MATCH",e[e.END=3]="END",e[e.PAUSE=4]="PAUSE",e[e.FAIL=5]="FAIL",e[e.WIN=6]="WIN",e[e.BOOM=7]="BOOM",e}({}));var r=e("TileType",function(e){return e[e.NONE=-1]="NONE",e[e.TYPE0=0]="TYPE0",e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2",e[e.TYPE3=3]="TYPE3",e[e.TYPE4=4]="TYPE4",e[e.TYPE5=5]="TYPE5",e[e.TYPE6=6]="TYPE6",e[e.TYPE7=7]="TYPE7",e[e.ROCKET=8]="ROCKET",e}({}));e("Popup",function(e){return e.FAILPOPUP="failPopUp",e.BOOMPOPUP="boomPopup",e.WINPOPUP="victoryPopup",e.PAUSEPOPUP="pausePopup",e}({})),e("Theme",function(e){return e.NONE="",e.CAKE="Img0_",e.FRUIT="Img1_",e.FISH="Img2_",e.CHAR="Img3_",e.VEHICLE="Img4_",e.ANIMAL="Img5_",e.FASHION="Img6_",e.SHELL="Img7_",e.BUTTERFLY="Img8_",e.DRINK="Img9_",e}({}));e("FIREWORK_PATH","sprite/AllTiles/firework/spriteFrame");e("SUBTILE_PATH","Canvas/SubtilePool"),e("ROCKET_NODE_PATH","Canvas/SubtilePool/RocketPool"),e("GRAVITY_NODE_PATH","Canvas/SubtilePool/GravityPool"),e("BOOM_NODE_PATH","Canvas/SubtilePool/BoomPool"),e("Direction",function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.RIGHT=2]="RIGHT",e[e.DOWN=3]="DOWN",e[e.LEFT=4]="LEFT",e}({})),e("directionValue",{none:new i(0,0),up:new i(0,1),right:new i(1,0),down:new i(0,-1),left:new i(-1,0)}),e("Item",function(e){return e.HINT="HintItem",e.BOOM="BoomDefuseItem",e.SHUFFLE="ShuffleItem",e.ROCKET="RocketItem",e}({})),e("ROCKET_PATH","sprite/prop_rocket/spriteFrame");t._RF.pop()}}}));

System.register("chunks:///_virtual/GoodPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(t){var i,e,n,o,r,a,s,c,u,l,h,p,g;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.SpriteFrame,c=t.Node,u=t.Sprite,l=t.Vec3,h=t.tween,p=t.Component},function(t){g=t.default}],execute:function(){var d,f,m,b,v,y,w,P,M,C,S,O,z;r._RF.push({},"d3896edoUNFH6c8V2svOnF6","GoodPopup",void 0);var L=a.ccclass,F=a.property;t("Good",(d=L("Good"),f=F(g),m=F([s]),b=F([s]),v=F(c),y=F(c),d((M=i((P=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return i=t.call.apply(t,[this].concat(r))||this,n(i,"gm",M,o(i)),i.timer=5,i.currentTime=0,i.comboCount=0,n(i,"listSprite",C,o(i)),n(i,"listLight",S,o(i)),i.boundOnMatchPair=null,n(i,"light",O,o(i)),n(i,"gud",z,o(i)),i}e(i,t);var r=i.prototype;return r.start=function(){this.gm&&(this.boundOnMatchPair=this.onMatchPair.bind(this),this.gm.onMatchPair(this.boundOnMatchPair)),this.node.active=!1},r.onDestroy=function(){this.gm&&this.boundOnMatchPair&&this.gm.offMatchPair(this.boundOnMatchPair)},r.update=function(t){this.currentTime+=t,this.currentTime>this.timer&&(this.node.active=!1,this.comboCount=0)},r.onMatchPair=function(){var t,i;if(this.comboCount++,!(this.comboCount<2)){var e=this.comboCount-2,n=Math.min(e,this.listSprite.length-1),o=null==(t=this.gud)?void 0:t.getComponent(u);o&&n>=0&&n<this.listSprite.length&&(o.spriteFrame=this.listSprite[n]);var r=null==(i=this.light)?void 0:i.getComponent(u);r&&n>=0&&n<this.listLight.length&&(r.spriteFrame=this.listLight[n]),this.gud.active=!1,this.light.active=!1,this.node.active=!0,this.playSequentialAnimation(),this.resetCombo()}},r.playSequentialAnimation=function(){var t=this;this.showLight((function(){t.showPic((function(){t.moveNodeUp()}))}))},r.showLight=function(t){this.light.active=!0,this.light.scale=new l(0,0,1),h(this.light).to(.1,{scale:new l(1,1,1)},{easing:"backOut"}).call((function(){t&&t()})).start()},r.showPic=function(t){this.gud.active=!0,this.gud.scale=new l(0,0,1),h(this.gud).to(.3,{scale:new l(1,1,1)},{easing:"backOut"}).call((function(){t&&t()})).start()},r.moveNodeUp=function(){var t=this,i=this.node.position.clone(),e=new l(i.x,i.y+30,i.z);h(this.node).to(.3,{position:e},{easing:"quadOut"}).delay(.2).call((function(){t.gud.active=!1,t.light.active=!1,t.node.position=i})).start()},r.resetCombo=function(){this.currentTime=0},i}(p)).prototype,"gm",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(P.prototype,"listSprite",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=i(P.prototype,"listLight",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=i(P.prototype,"light",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(P.prototype,"gud",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=P))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/GravityManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts"],(function(e){var t,r,a,i,n,c,o;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,a=e._decorator,i=e.Vec2,n=e.Component},function(e){c=e.directionValue,o=e.Direction}],execute:function(){var s,u;r._RF.push({},"82dfaktVwVLkrbOVb+WvtfO","GravityManager",void 0);var l=a.ccclass;a.property,e("GravityManager",l("GravityManager")(((u=function(e){function r(){return e.apply(this,arguments)||this}return t(r,e),r.setCircle=function(e){r.gravityChangable=!!e},r.changeGravity=function(e){switch(e){case o.DOWN:r.direction=c.down;break;case o.UP:r.direction=c.up;break;case o.LEFT:r.direction=c.left;break;case o.RIGHT:r.direction=c.right;break;default:r.direction=c.none}},r.setUpManager=function(e){this.changeGravity(o.DOWN)},r.cycleGravity=function(){if(this.gravityChangable){var e;switch(this.getCurrentDirection()){case o.UP:e=o.RIGHT;break;case o.RIGHT:e=o.DOWN;break;case o.DOWN:e=o.LEFT;break;case o.LEFT:e=o.UP;break;default:e=o.NONE}this.changeGravity(e)}},r.getCurrentDirection=function(){var e=this.direction;return e.equals(c.up)?o.UP:e.equals(c.right)?o.RIGHT:e.equals(c.down)?o.DOWN:e.equals(c.left)?o.LEFT:o.NONE},r}(n)).direction=new i,u.gravityChangable=!0,s=u))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/GravitySubTile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./GameManager.ts","./GravityManager.ts","./BaseSubTile.ts"],(function(t){var e,r,n,i,o,a,c,l,u;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,i=t.Vec2},function(t){o=t.Direction,a=t.TileType},function(t){c=t.default},function(t){l=t.GravityManager},function(t){u=t.BaseSubTile}],execute:function(){var f;r._RF.push({},"26465GJPW5B5o/Iu8qhYkx4","GravitySubTile",void 0);var s=n.ccclass;n.property,t("GravitySubTile",s("GravitySubtile")(f=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).changeAfterMove=!1,e}e(r,t);var n=r.prototype;return n.onAttach=function(e){t.prototype.onAttach.call(this,e)},n.onDead=function(t,e,r){if(this.tile&&r&&r.tile){var n=this.tile.getCoordinate(),i=r.tile.getCoordinate();if(e){var o=n.x*l.direction.x+n.y*l.direction.y,a=i.x*l.direction.x+i.y*l.direction.y>o?[r,this]:[this,r],c=a[0],u=a[1];c.tile.kill(),u.tile.kill(),c.resolveGravity(t)&&l.cycleGravity()}}},n.resolveGravity=function(t){var e,r=l.getCurrentDirection();if(r===o.NONE)return!1;console.log(r);var n=null==(e=this.node.parent)||null==(e=e.getComponent(c))?void 0:e.currentLevel;if(!n)return!1;var u=t.board.length,f=t.board[0].length,s=l.direction.x,v=l.direction.y,d=s+v>0,y=function(t){return Array.from({length:t},(function(t,e){return e})).slice(1,t-1)},g=!1;if(0!==v)for(var h=function(e){for(var r=y(u).map((function(r){return t.board[r][e]})),o=r.filter((function(t){return t.getTypeID()===a.NONE})),c=r.filter((function(t){return t.getTypeID()!==a.NONE})),l=d?[].concat(o,c):[].concat(c,o),f=0;f<l.length;f++){var s=f+1,v=l[f];t.board[s][e]!==v&&(g=!0),t.board[s][e]=v,v.setCoordinate(new i(e,s)),v.moveToRealPositionWithPadding(n)}},p=0;p<f;p++)h(p);else for(var b=function(e){for(var r=y(f).map((function(r){return t.board[e][r]})),o=r.filter((function(t){return t.getTypeID()===a.NONE})),c=r.filter((function(t){return t.getTypeID()!==a.NONE})),l=d?[].concat(o,c):[].concat(c,o),u=0;u<l.length;u++){var s=u+1,v=l[u];t.board[e][s]!==v&&(g=!0),t.board[e][s]=v,v.setCoordinate(new i(s,e)),v.moveToRealPositionWithPadding(n)}},T=0;T<u;T++)b(T);return g},r}(u))||f);r._RF.pop()}}}));

System.register("chunks:///_virtual/HintItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./BaseItem.ts"],(function(t){var n,o,e,i,r;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator},function(t){i=t.TileType},function(t){r=t.default}],execute:function(){var a;o._RF.push({},"129f9RmAKxFALGZ3rb0g4tX","HintItem",void 0);var l=e.ccclass;e.property,t("default",l("HintItem")(a=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.onUse=function(){var n;if(!this.clicked&&(t.prototype.onUse.call(this),0!=this.quantity)){var o=null==(n=this.game)||null==(n=n.board)?void 0:n.board;if(o){var e=!1;t:for(var r=0;r<o.length;r++)for(var a=0;a<o[0].length;a++){var l=o[r][a];if(l&&l.getTypeID()!=i.NONE)for(var s=r;s<o.length;s++)for(var h=r===s?a+1:0;h<o[0].length;h++){var u,g=o[s][h];if(g&&g.getTypeID()!=i.NONE&&(l!==g&&null!=(u=this.game)&&null!=(u=u.board)&&u.canMatch(l,g))){this.showHintEffect(l,g),e=!0;break t}}}e&&(this.quantity--,this.textChange())}}},e.showHintEffect=function(t,n){var o,e,i,r;null==(o=this.game)||o.unChoose();null==(e=this.game)||e.board;var a=null==(i=this.game)||null==(i=i.board)?void 0:i.getPath(t,n),l=this.getTurnPoints(a.path);null==(r=this.game)||r.hintTile.push(t,n),t.onHint(),n.onHint(),this.drawPath(l,this.game.pathPool),this.putStar(l,this.game.starPool)},e.getTurnPoints=function(t){if(t.length<2)return t;for(var n=[t[0]],o=1;o<t.length-1;o++){var e=t[o-1],i=t[o],r=t[o+1],a=i.x-e.x,l=i.y-e.y,s=r.x-i.x,h=r.y-i.y;a===s&&l===h||n.push(i)}return n.push(t[t.length-1]),n},e.drawPath=function(t,n){for(var o=0;o<t.length-1;o++){var e,i,r=t[o],a=(null==(e=this.game.board)?void 0:e.board[r.y][r.x]).node.getPosition().toVec2(),l=t[o+1],s=(null==(i=this.game.board)?void 0:i.board[l.y][l.x]).node.getPosition().toVec2(),h=n.getFirstItem();console.log("from: ",a,"to: ",s),null==h||h.createPath(a,s,!1),this.game.hintPath.push(h),console.log("draw path from",r,"to",l)}},e.putStar=function(t,n){for(var o=0;o<t.length;o++){var e,i,r=t[o],a=(null==(e=this.game)||null==(e=e.board)?void 0:e.board[r.y][r.x]).node.getPosition().clone(),l=n.getFirstItem();null==l||l.putAtForHint(a),null==(i=this.game)||i.hintPoint.push(l)}},o}(r))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/ItemManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./BaseItem.ts"],(function(t){var e,n,o,i,l,c,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,i=t._decorator,l=t.Component},function(t){c=t.Item},function(t){s=t.default}],execute:function(){var a;o._RF.push({},"af1dc3vGOxM0YqhvfMwuQjP","ItemManager",void 0);var u=i.ccclass;i.property,t("ItemManager",u("ItemManager")(a=function(t){function o(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))||this).game=null,e.itemList=new Map,e}e(o,t);var i=o.prototype;return i.onLoad=function(){this.cacheAllItem()},i.intialize=function(t){console.log(this.itemList),t&&(this.game=t),console.log("DONE INIT, GAME MANAGER: ",t);for(var e,o=n(this.itemList);!(e=o()).done;){var i=e.value,l=Number(localStorage.getItem(i[0]));0==l&&localStorage.setItem(i[0],"0"),console.log(l),i[1].setquantity(l),i[1].init(),t&&(i[1].game=this.game,console.log("init item: ",i[1],i[1].game))}},i.cacheAllItem=function(){var t=this;Object.values(c).forEach((function(e){var n=t.node.getChildByName(e);n&&t.itemList.set(e,n.getComponent(s)),console.log("cached: ",e)}))},i.useItem=function(t){var e=this.itemList.get(t);null==e||e.onUse(),0==(null==e?void 0:e.quantity)&&e.lock(),localStorage.setItem(t,String(null==e?void 0:e.quantity))},i.useHint=function(){var t;this.useItem(c.HINT),null==(t=this.itemList.get(c.HINT))||t.lock()},i.useBoom=function(){this.useItem(c.BOOM)},i.useShuffle=function(){this.useItem(c.SHUFFLE)},i.useRocket=function(){this.useItem(c.ROCKET)},i.unlockItem=function(t){var e;null==(e=this.itemList.get(t))||e.unlock()},i.lockItem=function(t){var e;null==(e=this.itemList.get(t))||e.lock()},i.lockAll=function(){this.itemList.forEach((function(t){t.lock()}))},i.unlockAll=function(){this.itemList.forEach((function(t){t.unlock()}))},o}(l))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Level.ts",["cc","./global.ts"],(function(i){var t,e,h;return{setters:[function(i){t=i.cclegacy,e=i.view},function(i){h=i.Theme}],execute:function(){t._RF.push({},"65509Fo80xNN5Sl/JgNMJaN","Level",void 0);i("Level",function(){function i(i,t,s,r,g,c,l,n){this.theme=h.CAKE,this.gridHeight=0,this.gridWidth=0,this.grid=[],this.time=void 0,this.tileSize=0,this.scale=0,this.gravity=0,this.circle=!1,this.layer=new Map,this.theme=r,this.gridHeight=i,this.gridWidth=t,this.grid=s,this.gravity=c,this.circle=l,this.scale=e.getVisibleSize().width/(this.gridWidth+2)/80,this.tileSize=80*this.scale+5,n&&(this.layer=n),this.time=g}var t=i.prototype;return t.change=function(i,t,h,s,r,g,c,l){this.theme=s,this.gridHeight=i,this.gridWidth=t,this.grid=h,this.gravity=g,this.circle=c,this.scale=Math.min(e.getVisibleSize().width/(this.gridWidth+3)/80,e.getVisibleSize().height/(this.gridHeight+10)/80),this.tileSize=80*this.scale+5,l&&(this.layer=l),this.time=r},t.getTime=function(){return this.time},t.getTileNum=function(){return this.gridHeight*this.gridWidth},i}());t._RF.pop()}}}));

System.register("chunks:///_virtual/LevelLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./Level.ts","./ShuffleLevel2.ts"],(function(e){var t,r,n,u,a,s,i,c;return{setters:[function(e){t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){n=e.cclegacy,u=e.resources,a=e.JsonAsset},function(e){s=e.Theme},function(e){i=e.Level},function(e){c=e.ShuffleLevel}],execute:function(){n._RF.push({},"808700sc6VHnLXKwlOdsw7G","LevelLoader",void 0),e("LevelLoader",function(){function e(){this.currentLevel=null,this.current=1,this.needToChange=!1,this.data=null,this.shuffleLevel=null,this.maxLevel=100,this.loadLevel(this.current)}e.getInstance=function(){return e.instance||(e.instance=new e),e.instance};var n=e.prototype;return n.checkNeedToChange=function(e){switch(e){case"completed":this.needToChange=!0;break;case"failed":this.needToChange=!1;break;case"skip":this.needToChange=!0}},n.loadLevelData=function(){var e=t(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n="map/map/level"+t;u.load(n,a,(function(r,n){if(r)console.error("Không load được level "+t+":",r),console.log("Test load:",r,n),e(null);else{var u=n.json;e(u)}}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadLevel=function(){var e=t(r().mark((function e(t){var n,u,a,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadLevelData(t);case 2:if(n=e.sent){e.next=6;break}return console.error("Không thể load level "+t),e.abrupt("return",!1);case 6:return this.data=n,this.shuffleLevel=new c(n),u=this.shuffleLevel.generateMap(),a=this.shuffleLevel.getMapLayer(u),s=this.getThemeFromString(n.Theme),this.currentLevel?this.currentLevel.change(n.GridHeight,n.GridWidth,u,s,n.Time,n.Gravity,n.Circle,a):(this.currentLevel=new i(n.GridHeight,n.GridWidth,u,s,n.Time,n.Gravity,n.Circle,a),console.log(this.currentLevel)),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getThemeFromString=function(e){switch(e.toUpperCase()){case"CAKE":return s.CAKE;case"FRUIT":return s.FRUIT;case"BUTTERFLY":return s.BUTTERFLY;case"DRINK":return s.DRINK;default:return s.CAKE}},n.changeLevel=function(){var e=t(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.needToChange){e.next=3;break}return console.log("Không cần change level"),e.abrupt("return",!1);case 3:if(!((t=this.current+1)>this.maxLevel)){e.next=7;break}return console.log("Đã hoàn thành tất cả level!"),e.abrupt("return",!1);case 7:return e.next=9,this.loadLevel(t);case 9:if(!e.sent){e.next=14;break}return this.current=t,this.needToChange=!1,e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.jumpToLevel=function(){var e=t(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<1||t>this.maxLevel)){e.next=3;break}return console.error("Level "+t+" không hợp lệ (1-"+this.maxLevel+")"),e.abrupt("return",!1);case 3:return e.next=5,this.loadLevel(t);case 5:if(!e.sent){e.next=11;break}return this.current=t,this.needToChange=!1,console.log("Jump đến level "+this.current),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.restartLevel=function(){var e=t(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadLevel(this.current);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.previousLevel=function(){var e=t(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.current<=1)){e.next=3;break}return console.log("Đã ở level đầu tiên"),e.abrupt("return",!1);case 3:return t=this.current-1,e.next=6,this.loadLevel(t);case 6:if(!e.sent){e.next=12;break}return this.current=t,this.needToChange=!1,console.log("Quay lại level "+this.current),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getCurrentLevel=function(){return this.currentLevel},n.getCurrentLevelNumber=function(){return this.current},n.getNeedToChange=function(){return this.needToChange},n.getLevelData=function(){return this.data},n.getShuffleLevel=function(){return this.shuffleLevel},n.setNeedToChange=function(e){this.needToChange=e},n.setMaxLevel=function(e){this.maxLevel=e},e}()).instance=null,n._RF.pop()}}}));

System.register("chunks:///_virtual/LoadTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./AnimationHandler.ts","./GravityManager.ts","./BaseTurn.ts"],(function(t){var n,e,r,a,u,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){r=t.Turn},function(t){a=t.AnimationHandler},function(t){u=t.GravityManager},function(t){i=t.BaseTurn}],execute:function(){e._RF.push({},"d5f4fF36RhJ4qZay0AgrkgB","LoadTurn",void 0);t("LoadTurn",function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;return i.onEnter=function(){var t,n,e,i,s;null==(t=this.game.pathPool)||t.returnAll(),null==(n=this.game.starPool)||n.returnAll(),this.game.subtilePool.forEach((function(t){t.returnAll()})),this.game.unChoose(),this.turnOffInput(),u.setUpManager(this.game.currentLevel),this.game.time=this.game.currentLevel.getTime(),this.game.matchPair=[],this.game.createBoard(this.game.currentLevel),null==(e=a.fillProgressBar)||e.resetProgressBar(),null==(i=a.fillProgressBar)||i.setTotal(this.game.currentLevel.getTileNum()),null==(s=a.fillProgressBar)||s.setLv(this.game.currentNumber()),this.turnOnInput(),this.game.switchTurn(r.START)},i.onExit=function(){},i.turnOnInput=function(){var t;null==(t=this.game.board)||t.setUpManager(this.game)},i.turnOffInput=function(){var t;null==(t=this.game.board)||t.resetInput()},e}(i));e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AssetLoader.ts","./BackGround.ts","./ShuffleLevel.ts","./AnimationHandler.ts","./FillProgressBar.ts","./Board.ts","./BaseItem.ts","./BoomDefuseItem.ts","./HintItem.ts","./RocketItem.ts","./ShuffleItem.ts","./Level.ts","./LevelLoader.ts","./ShuffleLevel2.ts","./GameManager.ts","./GravityManager.ts","./ItemManager.ts","./Path.ts","./BoomPool.ts","./PathPool.ts","./StarPool.ts","./TilePool.ts","./Star.ts","./BaseSubTile.ts","./BoomSubTile.ts","./ButterflySubTile.ts","./Countdown.ts","./GravitySubTile.ts","./Pulse.ts","./RocketSubTile.ts","./SubTilePool.ts","./SubTilePoolManager.ts","./Tile.ts","./Timer.ts","./BaseTurn.ts","./BombFail.ts","./EndTurn.ts","./FailTurn.ts","./LoadTurn.ts","./MatchTurn.ts","./PauseTurn.ts","./StartTurn.ts","./WinTurn.ts","./Combo.ts","./GoodPopup.ts","./UImanager.ts","./basePopup.ts","./Rotate.ts","./Sand.ts","./boom-popup.ts","./fail-popup.ts","./RotateStar.ts","./victoryPopup.ts","./GameConfig.ts","./global.ts","./type.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MatchTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./AnimationHandler.ts","./BaseTurn.ts"],(function(n){var t,i,e,o,r;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy},function(n){e=n.Turn},function(n){o=n.AnimationHandler},function(n){r=n.BaseTurn}],execute:function(){i._RF.push({},"517aeOebrlEc5HpaDQzdL6d","MatchTurn",void 0);n("MatchTurn",function(n){function i(){return n.apply(this,arguments)||this}t(i,n);var r=i.prototype;return r.onEnter=function(){var n=this;for(this.game.stopHint();this.game.matchPair.length>0;)this.game.match();Promise.all(o.animTile).then((function(){Promise.all(o.animList).then((function(){n.game.switchTurn(e.END)}))}))},r.onExit=function(){},r.onUpdate=function(){},i}(r));i._RF.pop()}}}));

System.register("chunks:///_virtual/Path.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AnimationHandler.ts"],(function(t){var e,n,o,i,a,r,l,s,c,h,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.Sprite,a=t.Vec3,r=t.Color,l=t.tween,s=t.Tween,c=t.Vec2,h=t.Component},function(t){u=t.AnimationHandler}],execute:function(){var d;n._RF.push({},"acc89i+H69Gj4VYQHePnuuj","Path",void 0);var p=o.ccclass;o.property,t("Path",p("Path")(d=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))||this).used=!1,e.headCoord=new c,e.tailCoord=new c,e}e(n,t);var o=n.prototype;return o.createPath=function(t,e,n){void 0===n&&(n=!0),this.headCoord=t,this.tailCoord=e,this.updateVisual(this.node,n)},o.calcDir=function(){var t=this.tailCoord.clone().subtract(this.headCoord.clone()),e=t.clone().normalize();return{angle:180*Math.atan2(e.y,e.x)/Math.PI,length:t.length()}},o.updateVisual=function(t,e){var n=this;void 0===e&&(e=!0);var o=t.getChildByName("Path"),s=o.getComponent(i),c=this.calcDir(),h=c.angle,d=c.length;t.angle=h-90,t.setPosition(this.headCoord.x,this.headCoord.y),console.log("length: ",d),o.setScale(new a(1,d/12)),s.color=new r(255,255,255,255),e&&u.animList.push(new Promise((function(t){l(s).delay(.1).to(.15,{color:new r(255,255,255,0)}).call((function(){s.color=new r(255,255,255,255),n.kill(),t()})).start()})))},o.isUsed=function(){return this.used},o.reSpawn=function(){this.used=!0,this.node.active=!0},o.kill=function(){this.used=!1;var t=this.node.getChildByName("Path");if(null!=t&&t.isValid){var e=t.getComponent(i);null!=e&&e.isValid&&(s.stopAllByTarget(e),e.color=new r(255,255,255,0),this.node.active=!1)}},n}(h))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/PathPool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Path.ts"],(function(t){var e,r,i,n,o,a,l,u,s,c,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized,o=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,l=t._decorator,u=t.Prefab,s=t.instantiate,c=t.Component},function(t){p=t.Path}],execute:function(){var f,h,d,v,P,b,m;a._RF.push({},"fb6aed0AFlLFYBJs4psdZpJ","PathPool",void 0);var y=l.ccclass,g=l.property;t("default",(f=y("PathPool"),h=g(u),d=g(Number),f((b=e((P=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"pathPrefab",b,n(e)),i(e,"size",m,n(e)),e.itemList=[],e}r(e,t);var a=e.prototype;return a.initialize=function(t){for(var e=0;e<this.size;e++){var r=s(this.pathPrefab);r&&(console.log("added child"),t.node.addChild(r)),this.itemList.push(null==r?void 0:r.getComponent(p))}this.returnAll()},a.getFirstItem=function(){for(var t,e=o(this.itemList);!(t=e()).done;){var r=t.value;if(!r.isUsed())return r.reSpawn(),r}return null},a.returnPool=function(t){t.kill()},a.returnMultiple=function(t){for(var e,r=o(t);!(e=r()).done;){e.value.kill()}},a.returnAll=function(){this.returnMultiple(this.itemList)},e}(c)).prototype,"pathPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(P.prototype,"size",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=P))||v));a._RF.pop()}}}));

System.register("chunks:///_virtual/PauseTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./UImanager.ts","./BaseTurn.ts"],(function(n){var t,u,e,o,r;return{setters:[function(n){t=n.inheritsLoose},function(n){u=n.cclegacy},function(n){e=n.Popup},function(n){o=n.UImanager},function(n){r=n.BaseTurn}],execute:function(){u._RF.push({},"4917fGp/FdAZ5CjyBwSBrh4","PauseTurn",void 0);n("PauseTurn",function(n){function u(){return n.apply(this,arguments)||this}t(u,n);var r=u.prototype;return r.onEnter=function(){this.game.turnOffInput(),this.game.unChoose(),console.log("Pause"),o.showPopup(e.PAUSEPOPUP,!0,this.game.currentNumber())},r.onExit=function(){},r.onUpdate=function(){},u}(r));u._RF.pop()}}}));

System.register("chunks:///_virtual/Pulse.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,r,s,a,c,o,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,c=e.tween,o=e.Vec3,l=e.Component}],execute:function(){var u,f,p,h,b;s._RF.push({},"e0c33H0tlRKgb4xR/17Vv4D","Pulse",void 0);var d=a.ccclass,y=a.property;e("Pulse",d("Pulse")((p=t((f=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,i(t,"frstscale",p,r(t)),i(t,"scndscale",h,r(t)),i(t,"time",b,r(t)),t}n(t,e);var s=t.prototype;return s.start=function(){this.startPulseEffect()},s.startPulseEffect=function(){c(this.node).to(this.time,{scale:new o(this.frstscale,this.frstscale,1)},{easing:"sineInOut"}).to(this.time,{scale:new o(this.scndscale,this.scndscale,1)},{easing:"sineInOut"}).union().repeatForever().start()},s.update=function(e){},t}(l)).prototype,"frstscale",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=t(f.prototype,"scndscale",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=t(f.prototype,"time",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),u=f))||u);s._RF.pop()}}}));

System.register("chunks:///_virtual/RocketItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./BaseItem.ts"],(function(e){var t,o,n,r,i,a,l,s,c,u,d,g,v,h,f,p,m,y,k,w,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,l=e._decorator,s=e.Node,c=e.Vec3,u=e.view,d=e.resources,g=e.SpriteFrame,v=e.Animation,h=e.Sprite,f=e.ParticleSystem2D,p=e.tween},function(e){m=e.FIREWORK_PATH,y=e.ROCKET_PATH,k=e.TileType,w=e.Turn},function(e){b=e.default}],execute:function(){var P,I,S,R,C,M,T;a._RF.push({},"6b0094l8LJMia3bOkZdOrCP","RocketItem",void 0);var x=l.ccclass,A=l.property;e("default",(P=x("RocketItem"),I=A(s),S=A(s),P((M=t((C=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(t,"overlay",M,r(t)),n(t,"rockets",T,r(t)),t}o(t,e);var a=t.prototype;return a.onUse=function(){var t,o,n;if(!this.clicked&&0!=this.quantity&&!this.locked){e.prototype.onUse.call(this);var r=this.getRandomMatchingPair();if(r){var a=new Set(r),l=this.getRandomMatchingPair(a);if(l){var s=[].concat(r,l);null==(t=this.game)||t.node.addChild(this.overlay),this.overlay.active=!0,this.overlay.setPosition(new c),null==(o=this.game)||o.unChoose(),null==(n=this.game)||n.turnOffInput();for(var u,d=i(null==(g=this.game)||null==(g=g.board)?void 0:g.board);!(u=d()).done;)for(var g,v,h=u.value,f=i(h);!(v=f()).done;){v.value.node.setSiblingIndex(1)}for(var p,m=i(s);!(p=m()).done;){p.value.node.setSiblingIndex(this.overlay.getSiblingIndex()+1)}this.showRocket(s),console.log("rocket"),this.quantity--,this.textChange()}}}},a.showRocket=function(e){var t=this;this.lock();for(var o=u.getVisibleSize().width/5,n=u.getVisibleSize(),r=d.get(m,g),i=d.get(y,g),a=function(a){var l,s;t.rockets[a].active=!0;var d=t.rockets[a].getChildByName("Rocket1"),g=null==(l=t.rockets[a].getChildByName("Explosion"))?void 0:l.getComponent(v);console.log(g),t.rockets[a].angle=0,d.getComponent(h).spriteFrame=r;var m=null==(s=t.rockets[a].getChildByName("RocketDust"))?void 0:s.getComponent(f);t.rockets[a].setWorldPosition(new c(o*(a+1),-100)),null==m||m.resetSystem(),d.active=!0;var y=a>=2?u.getVisibleSize().width+200:-200,k=t.getAngleBetween(t.rockets[a].worldPosition,new c(y,500));e[a].underKill=!0,t.rockets[a].setScale(.8,.8),p(t.rockets[a]).to(.5,{worldPosition:new c(o*(a+1),50)}).delay(.2).to(.1+.1*a,{angle:k-25}).to(.5,{worldPosition:new c(y,n.height/2)}).delay(.5).call((function(){t.rockets[a].setScale(1.2,1.2),d.getComponent(h).spriteFrame=i,t.rockets[a].angle=t.getAngleBetween(t.rockets[a].worldPosition,e[a].node.worldPosition),p(t.rockets[a]).to(.3+.1*a,{worldPosition:e[a].node.worldPosition},{easing:"sineOut"}).call((function(){var o,n;(e[a].onDead(t.game.board,a%2==0,a%2==0?e[a+1]:e[a-1]),e[a].kill(),e[a].node.setSiblingIndex(1),d.active=!1,g.node.active=!0,g.node.angle=-t.rockets[a].angle,null==g||g.play(),null==g||g.once(v.EventType.FINISHED,(function(){g.node.active=!1,t.rockets[a].setWorldPosition(new c(0,-100))})),t.overlay.active=!1,3==a)&&(null==(n=t.game)||n.turnOnInput(),t.unlock());null==(o=t.game)||o.switchTurn(w.MATCH)})).start()})).start()},l=0;l<e.length;l++)a(l)},a.getAngleBetween=function(e,t){var o=t.x-e.x,n=t.y-e.y;return 180*Math.atan2(n,o)/Math.PI-90+25},a.getRandomMatchingPair=function(e){var t;void 0===e&&(e=new Set);var o=null==(t=this.game)||null==(t=t.board)?void 0:t.board;if(!o)return null;for(var n,r=new Map,a=i(o);!(n=a()).done;)for(var l,s=n.value,c=i(s);!(l=c()).done;){var u=l.value,d=u;if(!e.has(d)){var g=u.getTypeID();g!==k.NONE&&(r.has(g)||r.set(g,[]),r.get(g).push(d))}}var v=Array.from(r.values()).filter((function(e){return e.length>=2}));if(0===v.length)return null;var h=v[Math.floor(Math.random()*v.length)].slice().sort((function(){return Math.random()-.5}));return[h[0],h[1]]},t}(b)).prototype,"overlay",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(C.prototype,"rockets",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=C))||R));a._RF.pop()}}}));

System.register("chunks:///_virtual/RocketSubTile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./AnimationHandler.ts","./GameManager.ts","./BaseSubTile.ts"],(function(e){var t,n,o,i,l,r,a,c,u,s,p,d,h,m,f,v,g,y,k,b,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,l=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,c=e.Node,u=e.Sprite,s=e.Animation,p=e.ParticleSystem2D,d=e.tween,h=e.Vec3},function(e){m=e.TileType,f=e.getTilePositionByLevel,v=e.Item,g=e.getScale,y=e.Turn},function(e){k=e.AnimationHandler},function(e){b=e.default},function(e){A=e.BaseSubTile}],execute:function(){var T,x,C,w,S,I,M,P,D,H,O,R,z;r._RF.push({},"83479iP3vZCo72QyCNS0T0K","RocketSubTile",void 0);var E=a.ccclass,K=a.property;e("RocketSubTile",(T=E("RocketSubTile"),x=K(c),C=K(u),w=K(u),S=K(s),I=K(s),T((D=t((P=function(e){function t(){for(var t,n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return t=e.call.apply(e,[this].concat(l))||this,o(t,"particle",D,i(t)),o(t,"rocket1",H,i(t)),o(t,"rocket2",O,i(t)),o(t,"exploAnim",R,i(t)),o(t,"exploAnim2",z,i(t)),t}n(t,e);var r=t.prototype;return r.onAttach=function(t){var n,o,i;e.prototype.onAttach.call(this,t),this.particle.active=!0,null==(n=this.tile)||n.wholeSprite.addChild(this.particle),null==(o=this.particle)||null==(o=o.getComponent(p))||o.resetSystem(),console.log(null==(i=this.tile)?void 0:i.node.position)},r.onDead=function(e,t,n){var o,i,r,a,c=this;if(this.kill(),null==(o=this.tile)||o.node.removeChild(this.particle),this.particle.active=!1,this.tile&&t){for(var u,p=new Map,A=l(e.board);!(u=A()).done;)for(var T,x=u.value,C=l(x);!(T=C()).done;){var w=T.value,S=w.getTypeID();S===m.NONE||w.underKill||w===this.tile||w===n.tile||(p.has(S)||p.set(S,[]),p.get(S).push(w))}var I=Array.from(p.entries()).filter((function(e){e[0];return e[1].length>=2}));if(0!==I.length){var M=I[Math.floor(Math.random()*I.length)],P=M[0],D=M[1].sort((function(){return Math.random()-.5})).slice(0,2);D[0].underKill=!0,D[1].underKill=!0;var H=null==(i=this.node.parent)?void 0:i.getComponent(b);console.log("explode random 2 tiles of type:",P),this.rocket1.node.active=!0,this.rocket2.node.active=!0;var O=this.tile.node.position,R=n.tile.node.position,z=f(D[0].getCoordinate().x,D[0].getCoordinate().y,H.currentLevel,1).toVec3(),E=f(D[1].getCoordinate().x,D[1].getCoordinate().y,H.currentLevel,1).toVec3();if(null==(r=this.rocket1)||r.node.setPosition(O),null==(a=this.rocket2)||a.node.setPosition(R),D&&D.length>=2&&this.rocket1&&this.rocket2){var K;null==(K=this.node.parent)||K.getComponent(b).itemManager.lockItem(v.ROCKET);var N=L(O,z),F=L(R,E);k.animTile.push(new Promise((function(t){d(c.rocket1.node).to(.2,{scale:new h(1.2*g().x,1.2*g().y,1),angle:N},{easing:"sineOut"}).to(.4,{position:z},{easing:"sineInOut"}).call((function(){var n,o,i,l,r;null==(n=c.node.parent)||n.getComponent(b).itemManager.unlockItem(v.ROCKET),D[0].onDead(e,!0,D[1]),D[0].kill(),c.rocket1.node.active=!1,c.rocket1.node.setScale(new h(1,1,1)),c.rocket1.node.angle=0,c.exploAnim.node.setPosition(null==(o=c.rocket1)?void 0:o.node.position),c.exploAnim.node.active=!0,null==(i=c.exploAnim)||i.play(),null==(l=c.exploAnim)||l.once(s.EventType.FINISHED,(function(){c.exploAnim.node.active=!1})),null==(r=c.node.parent)||null==(r=r.getComponent(b))||r.switchTurn(y.MATCH),t()})).start()}))),k.animTile.push(new Promise((function(t){d(c.rocket2.node).to(.2,{scale:new h(1.2*g().x,1.2*g().y,1),angle:F},{easing:"sineOut"}).to(.4,{position:E},{easing:"sineInOut"}).call((function(){var n,o,i,l;D[1].onDead(e,!1,D[0]),D[1].kill(),c.rocket2.node.active=!1,c.rocket2.node.setScale(new h(1,1,1)),c.rocket2.node.angle=0,c.exploAnim2.node.setPosition(null==(n=c.rocket2)?void 0:n.node.position),c.exploAnim2.node.active=!0,null==(o=c.exploAnim2)||o.play(),null==(i=c.exploAnim2)||i.once(s.EventType.FINISHED,(function(){c.exploAnim2.node.active=!1})),null==(l=c.node.parent)||null==(l=l.getComponent(b))||l.switchTurn(y.MATCH),t()})).start()})))}}}},t}(A)).prototype,"particle",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(P.prototype,"rocket1",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(P.prototype,"rocket2",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(P.prototype,"exploAnim",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(P.prototype,"exploAnim2",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=P))||M));function L(e,t){var n=t.x-e.x,o=t.y-e.y;return 180*Math.atan2(o,n)/Math.PI-90+25}r._RF.pop()}}}));

System.register("chunks:///_virtual/Rotate.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,r,n,a;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,r=t._decorator,n=t.tween,a=t.Component}],execute:function(){var c;o._RF.push({},"48be9MUFW9F46I/P/pHk7MG","Rotate",void 0);var s=r.ccclass;r.property,t("Rotate",s("Rotate")(c=function(t){function o(){return t.apply(this,arguments)||this}e(o,t);var r=o.prototype;return r.start=function(){this.rotate()},r.rotate=function(){n(this.node).by(1.5,{angle:360}).repeatForever().start()},o}(a))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/RotateStar.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,r,a,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,r=t.tween,a=t.Vec3,s=t.Component}],execute:function(){var c;n._RF.push({},"619d7FYvcVN0b+/E8HeIEFB","RotateStar",void 0);var i=o.ccclass;o.property,t("RotateStar",i("RotateStar")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.start=function(){},o.rotateLoop=function(){r(this.node).parallel(r().to(.2,{angle:4}).to(1,{angle:-4}).to(.5,{angle:0}),r().to(.2,{scale:new a(1.1,1.1,1)},{easing:"sineInOut"}).to(.2,{scale:new a(1.2,1.2,1)},{easing:"sineInOut"})).repeatForever().start()},n}(s))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Sand.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,o,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,o=t.tween,a=t.Component}],execute:function(){var s;n._RF.push({},"13955tJWsxLsLQhgQ3zAeZZ","Sand",void 0);var c=r.ccclass;r.property,t("Sand",c("Sand")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.start=function(){this.rotate()},r.rotate=function(){var t=this;o(this.node).repeatForever(o().to(.5,{angle:180}).delay(.3).call((function(){return t.node.angle=0})).delay(.2)).start()},n}(a))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/ShuffleItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseItem.ts"],(function(t){var e,n,s,i;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,s=t._decorator},function(t){i=t.default}],execute:function(){var o;n._RF.push({},"438ffQp8BhHubr0sDJ7hdL0","ShuffleItem",void 0);var u=s.ccclass;s.property,t("ShuffleItem",u("ShuffleItem")(o=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onUse=function(){var e;this.clicked||this.locked||(t.prototype.onUse.call(this),(null==(e=this.game)?void 0:e.board).shuffle(),this.quantity>0&&(this.quantity-=1,this.textChange()))},n}(i))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/ShuffleLevel.ts",["cc"],(function(){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){e._RF.push({},"c215bmfg1lHvYYueRESS7r2","ShuffleLevel",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/ShuffleLevel2.ts",["cc","./global.ts","./GravityManager.ts"],(function(t){var i,r,e,n;return{setters:[function(t){i=t.cclegacy},function(t){r=t.Direction,e=t.SubType},function(t){n=t.GravityManager}],execute:function(){i._RF.push({},"f7407cbz29Dxrai4GTJytW0","ShuffleLevel",void 0);t("ShuffleLevel",function(){function t(t){this.gridHeight=void 0,this.gridWidth=void 0,this.data=void 0,this.RocketTile=void 0,this.difficulty=void 0,this.Timer=void 0,this.grid=[],this.layerList=new Map,this.gridHeight=t.GridHeight,this.gridWidth=t.GridWidth,this.RocketTile=t.Tiles.RocketTiles,this.difficulty=t.Difficulty,this.Timer=t.Time,this.data=t}var i=t.prototype;return i.changeLevel=function(t){this.gridHeight=t.GridHeight,this.gridWidth=t.GridWidth,this.RocketTile=t.Tiles.RocketTiles,this.difficulty=t.Difficulty,this.Timer=t.Time,this.data=t},i.shuffle=function(){var t=this;this.grid=Array(this.gridHeight).fill(null).map((function(){return Array(t.gridWidth).fill(-1)}));var i=[];Object.entries(this.data.Tiles.NormalTiles).forEach((function(t){for(var r=t[0],e=t[1],n=Math.floor(Number(e)/2),s=0;s<n;s++)i.push({tileId:parseInt(r),positions:[]})}));for(var r=Math.floor(this.RocketTile/2),e=0;e<r;e++)i.push({tileId:8,positions:[]});for(var n=this.shuffleArray([].concat(i)),s=n.length,h=Math.floor(2*s/3),o=this.getAllPositions(),a=[].concat(o),f=function(){var i=n[c],r=t.getStrategicPositions(a,t.difficulty);i.positions=r,r.forEach((function(r){t.grid[r.y][r.x]=i.tileId;var e=a.findIndex((function(t){return t.x===r.x&&t.y===r.y}));e>-1&&a.splice(e,1)}))},c=0;c<h;c++)f();for(var l=h;l<s;l++){for(var u=n[l],d=[],g=0;g<2&&a.length>0;g++){var y=Math.floor(Math.random()*a.length),v=a.splice(y,1)[0];d.push(v),this.grid[v.y][v.x]=u.tileId}u.positions=d}return this.grid},i.getStrategicPositions=function(t,i){return t.length<2?t.splice(0,2):i<=2?this.getNearbyPositions(t):this.getDistantPositions(t)},i.getNearbyPositions=function(t){for(var i=[],r=1/0,e=0;e<t.length;e++)for(var n=e+1;n<t.length;n++){var s=t[e],h=t[n],o=this.calculateDistance(s,h);o<r&&(r=o,i=[s,h])}return i.forEach((function(i){var r=t.findIndex((function(t){return t.x===i.x&&t.y===i.y}));r>-1&&t.splice(r,1)})),2===i.length?i:this.getRandomPositions(t,2)},i.getDistantPositions=function(t){for(var i=[],r=0,e=0;e<t.length;e++)for(var n=e+1;n<t.length;n++){var s=t[e],h=t[n],o=this.calculateDistance(s,h);o>r&&(r=o,i=[s,h])}return i.forEach((function(i){var r=t.findIndex((function(t){return t.x===i.x&&t.y===i.y}));r>-1&&t.splice(r,1)})),2===i.length?i:this.getRandomPositions(t,2)},i.calculateDistance=function(t,i){return Math.abs(t.x-i.x)+Math.abs(t.y-i.y)},i.getRandomPositions=function(t,i){for(var r=[],e=0;e<i&&t.length>0;e++){var n=Math.floor(Math.random()*t.length);r.push(t.splice(n,1)[0])}return r},i.isEasyEnough=function(){for(var t=0,i=0;i<this.gridHeight;i++)for(var r=0;r<this.gridWidth;r++)-1!==this.grid[i][r]&&(r<this.gridWidth-1&&this.grid[i][r]===this.grid[i][r+1]&&t++,i<this.gridHeight-1&&this.grid[i][r]===this.grid[i+1][r]&&t++);return this.difficulty<=2?t>=8:this.difficulty<=3.5?t>=4&&t<=8:t<=3},i.generateMap=function(){return this.shuffle()},i.shuffleArray=function(t){for(var i=[].concat(t),r=i.length-1;r>0;r--){var e=Math.floor(Math.random()*(r+1)),n=[i[e],i[r]];i[r]=n[0],i[e]=n[1]}return i},i.getAllPositions=function(){for(var t=[],i=0;i<this.gridHeight;i++)for(var r=0;r<this.gridWidth;r++)t.push({x:r,y:i});return t},i.checkDirection=function(){switch(this.data.Gravity){case 0:return r.NONE;case 1:return r.LEFT;case 2:return r.RIGHT;case 3:return r.UP;case 4:return r.DOWN;default:return r.NONE}},i.getMapLayer=function(t){for(var i=this,r=Array.from({length:this.gridHeight},(function(){return Array(i.gridWidth).fill(0)})),s=Array.from({length:this.gridHeight},(function(){return Array(i.gridWidth).fill(0)})),h=Array.from({length:this.gridHeight},(function(){return Array(i.gridWidth).fill(0)})),o=[],a=0;a<this.gridHeight;a++)for(var f=0;f<this.gridWidth;f++)n.setCircle(this.data.Circle),this.data.Gravity&&(h[a][f]=1),8==t[a][f]?r[a][f]=1:(r[a][f]=0,o.push({x:f,y:a}));console.log(this.checkDirection()),n.changeGravity(this.checkDirection());for(var c=this.data.Tiles.BombEffects,l=0;l<c;l++){var u=Math.floor(Math.random()*o.length),d=o.splice(u,1)[0],g=d.x;s[d.y][g]=1}return this.layerList.set(e.ROCKET,r),this.layerList.set(e.BOOM,s),this.layerList.set(e.GRAVITY,h),this.layerList},i.getGrid=function(){return this.grid},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/Star.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AnimationHandler.ts"],(function(t){var e,i,n,o,r,a,l,s,c,u,h,d,p,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Sprite,s=t.Node,c=t.UITransform,u=t.tween,h=t.Vec3,d=t.ParticleSystem2D,p=t.Component},function(t){f=t.AnimationHandler}],execute:function(){var v,m,w,y,g,b,S,P,x,M,A,z,C;r._RF.push({},"33b93Zd5mNJZ4pCIbu6p1BS","Star",void 0);var k=a.ccclass,B=a.property;t("Star",(v=k("Star"),m=B(l),w=B(l),y=B(s),g=B(s),b=B(s),v((x=e((P=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).used=!1,n(e,"circle",x,o(e)),n(e,"star",M,o(e)),n(e,"match",A,o(e)),n(e,"trail",z,o(e)),n(e,"death",C,o(e)),e}i(e,t);var r=e.prototype;return r.putAt=function(t){var e,i,n=this;this.node.setPosition(t),this.star.node.active=!0,this.circle.node.active=!1;var o=null==(e=f.fillProgressBar)?void 0:e.currentStar;if(o){var r=o.getWorldPosition(),a=(null==(i=this.node.parent)||null==(i=i.getComponent(c))?void 0:i.convertToNodeSpaceAR(r))||r;f.animList.push(new Promise((function(t){u(n.node).delay(.8).call((function(){n.follow()})).to(.7,{position:a,scale:new h(2,2,1)},{easing:"quadOut"}).call((function(){f.callProgress(),n.trail.active=!1})).delay(.1).call((function(){n.explode()})).delay(.5).call((function(){n.kill(),t()})).start()})))}},r.putAtForHint=function(t){this.star.node.active=!1,this.node.setPosition(t),this.circle.node.active=!0},r.isUsed=function(){return this.used},r.reSpawn=function(){this.node.setScale(1.5,1.5),this.used=!0,this.node.active=!0},r.kill=function(){this.death.active=!1,this.trail.active=!1,this.node.scale=new h(1,1,1),this.star.node.active=!1,this.match.active=!1,this.circle.node.active=!1,this.used=!1,this.node.active=!1},r.firstAndLastMatch=function(){var t;this.match.active=!0,null==(t=this.match)||null==(t=t.getComponent(d))||t.resetSystem()},r.explode=function(){var t,e;this.death.active=!0,this.star.node.active=!1,null==(t=this.death)||null==(t=t.getComponent(d))||t.resetSystem(),null==(e=f.fillProgressBar)||e.checkActive()},r.follow=function(){var t;this.trail.active=!0,null==(t=this.trail)||null==(t=t.getComponent(d))||t.resetSystem()},r.winPut=function(t){var e,i=this;this.star.node.active=!0,this.circle.node.active=!1,this.node.setWorldPosition(t),this.follow();var n=null==(e=f.fillProgressBar)?void 0:e.currentStar;if(n){var o=n.getWorldPosition(),r=t,a=o,l=new h(r.x+.3*(a.x-r.x),r.y-80,0),s=new h(r.x+.7*(a.x-r.x),a.y-60,0);f.animList.push(new Promise((function(t){u({t:0}).to(.7,{t:1},{onUpdate:function(t){if(t){var e=t.t,n=Math.pow(1-e,3)*r.x+3*Math.pow(1-e,2)*e*l.x+3*(1-e)*Math.pow(e,2)*s.x+Math.pow(e,3)*a.x,o=Math.pow(1-e,3)*r.y+3*Math.pow(1-e,2)*e*l.y+3*(1-e)*Math.pow(e,2)*s.y+Math.pow(e,3)*a.y,c=new h(n,o,0);i.node.setWorldPosition(c);var u=1+e;i.node.setScale(u,u,1)}},easing:"quadOut"}).call((function(){i.kill(),t()})).start()})))}},e}(p)).prototype,"circle",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(P.prototype,"star",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(P.prototype,"match",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(P.prototype,"trail",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(P.prototype,"death",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=P))||S));r._RF.pop()}}}));

System.register("chunks:///_virtual/StarPool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Star.ts"],(function(t){var e,r,i,n,o,l,a,u,s,c,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized,o=t.createForOfIteratorHelperLoose},function(t){l=t.cclegacy,a=t._decorator,u=t.Prefab,s=t.instantiate,c=t.Component},function(t){p=t.Star}],execute:function(){var f,h,d,v,b,m,y;l._RF.push({},"56628dzOJROhJhl1rXXnlo8","StarPool",void 0);var P=a.ccclass,g=a.property;t("default",(f=P("StarPool"),h=g(u),d=g(Number),f((m=e((b=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o))||this,i(e,"pathPrefab",m,n(e)),i(e,"size",y,n(e)),e.itemList=[],e}r(e,t);var l=e.prototype;return l.initialize=function(t){for(var e=0;e<this.size;e++){var r=s(this.pathPrefab);r&&(console.log("added child"),t.node.addChild(r)),this.itemList.push(null==r?void 0:r.getComponent(p))}this.returnAll()},l.getFirstItem=function(){for(var t,e=o(this.itemList);!(t=e()).done;){var r=t.value;if(!r.isUsed())return r.reSpawn(),r}return null},l.returnPool=function(t){t.kill()},l.returnMultiple=function(t){for(var e,r=o(t);!(e=r()).done;){e.value.kill()}},l.returnAll=function(){this.returnMultiple(this.itemList)},e}(c)).prototype,"pathPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(b.prototype,"size",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=b))||v));l._RF.pop()}}}));

System.register("chunks:///_virtual/StartTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./BaseTurn.ts"],(function(t){var n,e,i,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){i=t.Turn},function(t){r=t.BaseTurn}],execute:function(){e._RF.push({},"8446640he9A4aLCzzhPV5qN","StartTurn",void 0);t("StartTurn",function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var r=e.prototype;return r.onEnter=function(){this.game.isWin()?this.game.switchTurn(i.LOAD):this.game.matchPair.length>0?this.game.switchTurn(i.MATCH):this.game.showItem()},r.onExit=function(){},e}(r));e._RF.pop()}}}));

System.register("chunks:///_virtual/SubTilePool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseSubTile.ts"],(function(e){var t,i,r,n,o,l,u,a,s,c,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){l=e.cclegacy,u=e._decorator,a=e.Prefab,s=e.instantiate,c=e.Component},function(e){f=e.BaseSubTile}],execute:function(){var p,d,b,h,v;l._RF.push({},"6abaecMCXJMGaMNASv2EoDQ","SubTilePool",void 0);var P=u.ccclass,m=u.property;e("default",(p=P("SubTilePool"),d=m(a),p((v=t((h=function(e){function t(t){var i;return i=e.call(this)||this,r(i,"subTilePrefab",v,n(i)),i.size=70,i.itemList=[],i}i(t,e);var l=t.prototype;return l.initialize=function(e){for(var t=0;t<this.size;t++){var i=s(this.subTilePrefab);i&&(console.log("added child"),e.node.addChild(i)),this.itemList.push(null==i?void 0:i.getComponent(f))}this.returnAll()},l.getFirstItem=function(){for(var e,t=o(this.itemList);!(e=t()).done;){var i=e.value;if(!i.isUsed())return i.reSpawn(),i}return null},l.returnPool=function(e){e.kill()},l.returnMultiple=function(e){for(var t,i=o(e);!(t=i()).done;){t.value.kill()}},l.returnAll=function(){this.returnMultiple(this.itemList)},t}(c)).prototype,"subTilePrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=h))||b));l._RF.pop()}}}));

System.register("chunks:///_virtual/SubTilePoolManager.ts",["cc"],(function(){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){e._RF.push({},"c891fSXY/dP55IEbIOEqz8m","SubTilePoolManager",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Tile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./AnimationHandler.ts"],(function(e){var t,i,n,o,s,r,a,l,c,h,u,p,f,d,g,S,y,m,w,T,b,v,C,k,D;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,l=e.Sprite,c=e.Node,h=e.Vec2,u=e.resources,p=e.SpriteFrame,f=e.Tween,d=e.Vec3,g=e.tween,S=e.Color,y=e.UITransform,m=e.Size,w=e.Component},function(e){T=e.Theme,b=e.TileType,v=e.getTilePath,C=e.SubType,k=e.getTilePositionByLevel},function(e){D=e.AnimationHandler}],execute:function(){var I,L,O,P,A,E,z,F,N,R,q,x,G;r._RF.push({},"4fdf9U4ak9Guqei/yF8Luzo","Tile",void 0);var H=a.ccclass,U=a.property;e("default",(I=H("Tile"),L=U(l),O=U(l),P=U(c),A=U(c),E=U(c),I((N=t((F=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,n(t,"itemTypeSprite",N,o(t)),n(t,"backGroundSpite",R,o(t)),n(t,"wholeSprite",q,o(t)),n(t,"choosingEffect",x,o(t)),n(t,"rotatedChoosingEff",G,o(t)),t.underKill=!1,t.selfPromise=[],t.originScale=1,t.used=!1,t.theme=T.NONE,t.coordinate=new h,t.typeID=b.NONE,t.hintAnimation=null,t.subTileList=new Map,t.onClickCallbacks=[],t}i(t,e);var r=t.prototype;return r.start=function(){},r.getSubtileList=function(){return this.subTileList},r.setTheme=function(e){if(e!=this.theme){this.theme=e;var t=v(this.typeID,this.theme),i=u.get(t,p);this.itemTypeSprite&&(this.itemTypeSprite.spriteFrame=i)}},r.getTheme=function(){return this.theme},r.addOnClickCallback=function(e){this.onClickCallbacks.push(e)},r.emitOnClickCallbacks=function(){var e=this;this.onClickCallbacks.forEach((function(t){t(e)}))},r.clearOnClickCallbacks=function(){this.onClickCallbacks=[]},r.getCoordinate=function(){return this.coordinate},r.setCoordinate=function(e){this.coordinate=new h(e.x,e.y)},r.getTypeID=function(){return this.typeID},r.isUsed=function(){return this.used},r.reSpawn=function(){this.used=!0,this.wholeSprite.active=!0},r.hide=function(){this.setTypeID(b.NONE),this.wholeSprite.active=!1},r.kill=function(){f.stopAllByTarget(this.wholeSprite),this.wholeSprite.scale=new d(this.originScale,this.originScale),this.wholeSprite.angle=0,this.underKill=!1,this.setTypeID(b.NONE),this.used=!1,this.wholeSprite.active=!1},r.setTypeID=function(e){if(e!=this.typeID){this.typeID=e;var t=v(this.typeID,this.theme),i=u.get(t,p);this.itemTypeSprite&&(this.itemTypeSprite.spriteFrame=i)}},r.attachSubType=function(e,t){this.subTileList.set(t,e),e.onAttach(this)},r.detachSubType=function(e){var t;null==(t=this.subTileList.get(e))||t.onDetach(),this.subTileList.delete(e)},r.onDead=function(e,t,i){var n,o=i.subTileList.get(C.GRAVITY);null==(n=this.subTileList.get(C.GRAVITY))||n.onDead(e,t,o),this.detachSubType(C.GRAVITY);for(var r,a=s(this.subTileList);!(r=a()).done;){var l=r.value,c=i.subTileList.get(l[0]);l[1].onDead(e,t,c),this.detachSubType(l[0])}},r.moveToRealPosition=function(e){var t=k(this.coordinate.x,this.coordinate.y,e);this.node.setPosition(new d(t.x,t.y))},r.onHint=function(){this.hintAnimation?this.hintAnimation.start():this.hintAnimation=g(this.wholeSprite).repeatForever(g().to(.2,{scale:new d(.7*this.originScale,.7*this.originScale)}).to(.1,{angle:20},{easing:"quadOut"}).to(.1,{angle:-20},{easing:"quadOut"}).to(.1,{angle:20},{easing:"quadOut"}).to(.1,{angle:0},{easing:"quadOut"}).to(.2,{scale:new d(this.originScale,this.originScale)})).start()},r.onUnHint=function(){var e;this.wholeSprite&&(null==(e=this.hintAnimation)||e.stop(),this.wholeSprite.angle=0,g(this.wholeSprite).to(.05,{scale:new d(this.originScale,this.originScale)},{easing:"backOut"}).start())},r.fadeIn=function(e){var t,i,n=null==(t=this.wholeSprite)?void 0:t.getComponent(l);n.color=new S(255,255,255,0),null==(i=this.wholeSprite)||i.setScale(new d),g(n).delay(e).to(.5,{color:new S(255,255,255,255)}).start(),g(this.wholeSprite).delay(e).to(.5,{scale:new d(this.originScale,this.originScale,1)}).start()},r.moveToRealPositionWithPadding=function(e,t,i,n,o){var s=this;void 0===t&&(t=!0),void 0===i&&(i=0),void 0===n&&(n="quadOut"),void 0===o&&(o=.5);var r=k(this.coordinate.x-1,this.coordinate.y-1,e),a=new d(r.x,r.y,0);t?D.animTile.push(new Promise((function(e){g(s.node).delay(i).to(o,{position:a},{easing:n}).call((function(){e()})).start()}))):this.node.setPosition(a)},r.reScale=function(e,t){var i,n;null==(i=this.wholeSprite)||i.setScale(new d(e,e)),this.originScale=e,null==(n=this.node.getComponent(y))||n.setContentSize(new m(80*e,80*e))},r.onChoose=function(){var e=this;this.choosingEffect.active=!0,Promise.all(this.selfPromise).then((function(){e.selfPromise.push(new Promise((function(t){g(e.wholeSprite).to(.1,{scale:new d(.7*e.originScale,.7*e.originScale)}).to(.1,{scale:new d(e.originScale,e.originScale)}).call((function(){t()})).start()})))})),g(this.rotatedChoosingEff).repeatForever(g().by(1,{angle:360})).start()},r.onUnchoose=function(){this.choosingEffect.active=!1},r.shrink=function(){var e;null==(e=this.itemTypeSprite)||e.node.setScale(new d),g(this.itemTypeSprite.node).to(.3,{scale:new d(1,1)},{easing:"backOut"}).start()},t}(w)).prototype,"itemTypeSprite",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(F.prototype,"backGroundSpite",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(F.prototype,"wholeSprite",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(F.prototype,"choosingEffect",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(F.prototype,"rotatedChoosingEff",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=F))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/TilePool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./Tile.ts"],(function(e){var t,i,n,r,o,l,a,s,u,c,f,p,d,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){l=e.cclegacy,a=e._decorator,s=e.Prefab,u=e.instantiate,c=e.tween,f=e.Vec3,p=e.Component},function(e){d=e.getTilePositionByLevel},function(e){h=e.default}],execute:function(){var v,g,b,m,y,P,L;l._RF.push({},"a66d1k6sRREzqELqEAJOtRR","TilePool",void 0);var k=a.ccclass,z=a.property;e("default",(v=k("TilePool"),g=z(s),b=z(Number),v((P=t((y=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,n(t,"tilePrefab",P,r(t)),n(t,"size",L,r(t)),t.itemList=[],t.shaking=!1,t}i(t,e);var l=t.prototype;return l.initialize=function(e){for(var t=0;t<this.size;t++){var i=u(this.tilePrefab);i&&(console.log("added child"),e.node.addChild(i)),this.itemList.push(null==i?void 0:i.getComponent(h))}this.returnAll()},l.shake=function(e,t){var i=this;if(!this.shaking){this.shaking=!0;for(var n,r=o(this.itemList);!(n=r()).done;){var l=n.value;if(l.isUsed()){var a=d(l.getCoordinate().x,l.getCoordinate().y,t,1).toVec3();c(l.node).to(.05,{position:a.clone().add(new f(e,e))}).to(.05,{position:a.clone().subtract(new f(e,e))}).to(.05,{position:a}).call((function(){return i.shaking=!1})).start()}}}},l.getFirstItem=function(){for(var e,t=o(this.itemList);!(e=t()).done;){var i=e.value;if(!i.isUsed())return i.reSpawn(),i}return null},l.returnPool=function(e){e.kill(),e.node.setPosition(new f)},l.returnMultiple=function(e){for(var t,i=o(e);!(t=i()).done;){t.value.kill()}},l.returnAll=function(){this.returnMultiple(this.itemList)},t}(p)).prototype,"tilePrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(y.prototype,"size",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=y))||m));l._RF.pop()}}}));

System.register("chunks:///_virtual/Timer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./GameManager.ts"],(function(i){var t,e,r,n,s,o,a,m,g,h;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,r=i.initializerDefineProperty,n=i.assertThisInitialized},function(i){s=i.cclegacy,o=i._decorator,a=i.Label,m=i.Component},function(i){g=i.Turn},function(i){h=i.default}],execute:function(){var c,u,l,p,T;s._RF.push({},"66f8aBZv6RGz5IalYI5GxGc","Timer",void 0);var f=o.ccclass,d=o.property;i("Timer",(c=f("Timer"),u=d(h),c((T=t((p=function(i){function t(){for(var t,e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return t=i.call.apply(i,[this].concat(s))||this,r(t,"gm",T,n(t)),t.hasTriggeredTimeUp=!1,t}e(t,i);var s=t.prototype;return s.start=function(){var i=this.node.getComponent(a);this.gm&&i&&(i.string=this.convertTime(this.gm.time)),this.hasTriggeredTimeUp=!1},s.convertTime=function(i){return Math.floor(i/60)+":"+(i%60).toString().padStart(2,"0")},s.update=function(i){if(this.gm&&!this.gm.ispause){var t=this.node.getComponent(a);this.gm.time>0&&this.hasTriggeredTimeUp&&(this.hasTriggeredTimeUp=!1),this.gm.time>0&&(this.gm.time-=i,this.gm.time<0&&(this.gm.time=0),t&&(t.string=this.convertTime(Math.ceil(this.gm.time)))),this.gm.time<=0&&!this.hasTriggeredTimeUp&&(console.log("Time up!"),this.hasTriggeredTimeUp=!0,this.gm.isWin()||this.gm.switchTurn(g.FAIL),t&&(t.string=this.convertTime(0)))}},s.isWin=function(){var i;null!=(i=this.gm)&&i.isWin()&&this.gm.time},t}(m)).prototype,"gm",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=p))||l));s._RF.pop()}}}));

System.register("chunks:///_virtual/type.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("TileConnect",void 0),e._RF.push({},"b1d490w25hJl6tzYD9F8pgq","type",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/UImanager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./basePopup.ts"],(function(n){var e,o,t,a,p,i,s,c,u,r,l,f;return{setters:[function(n){e=n.applyDecoratedDescriptor,o=n.inheritsLoose,t=n.initializerDefineProperty,a=n.assertThisInitialized},function(n){p=n.cclegacy,i=n._decorator,s=n.Node,c=n.Vec3,u=n.tween,r=n.Component},function(n){l=n.Popup},function(n){f=n.BasePopup}],execute:function(){var d,h,v,g,P,m,y,w;p._RF.push({},"306aehmDdVK9KkrxQbG4DJr","UImanager",void 0);var b=i.ccclass,C=i.property;n("UImanager",(d=b("UImanager"),h=C(s),v=C(s),d(((w=function(n){function e(){for(var e,o=arguments.length,p=new Array(o),i=0;i<o;i++)p[i]=arguments[i];return e=n.call.apply(n,[this].concat(p))||this,t(e,"overlay",m,a(e)),e.popupNodes=new Map,e.popupComponents=new Map,t(e,"pauseButton",y,a(e)),e}o(e,n);var p=e.prototype;return p.start=function(){e.instance=this,this.cachePopupNodes(),this.hideAllPopups()},e.togglePauseButton=function(n){e.instance.pauseButton.active=n||!e.instance.pauseButton.active},p.hideAllPopups=function(){var n=this;e.instance.overlay.active=!1,this.popupNodes.forEach((function(e,o){var t=n.popupComponents.get(o);t&&e.active&&t.onPopupHide(),e.active=!1}))},e.showPopup=function(n,o,t){if(void 0===o&&(o=!0),e.instance){o&&e.instance.hideAllPopups();var a=e.instance.popupNodes.get(n),p=e.instance.popupComponents.get(n);a?(e.instance.overlay.active=!0,a.active=!0,a.scale=new c(0,0,1),u(a).to(.3,{scale:new c(1,1,1)},{easing:"backOut"}).start(),p&&p.onPopupShow(t)):console.warn("Popup not found: "+n)}else console.warn("UIManager instance not found!")},e.hidePopup=function(n){if(e.instance){var o=e.instance.popupNodes.get(n),t=e.instance.popupComponents.get(n);o&&o.active&&(e.instance.overlay.active=!1,t&&t.onPopupHide(),o.active=!1)}else console.warn("UIManager instance not found!")},e.hideAllPopups=function(){e.instance?(e.instance.hideAllPopups(),console.log("Hidden all popups")):console.warn("UIManager instance not found!")},p.cachePopupNodes=function(){var n=this;Object.values(l).forEach((function(e){var o=n.node.getChildByName(e);if(o){n.popupNodes.set(e,o);var t=o.getComponent(f);t&&(n.popupComponents.set(e,t),console.log("Cached popup component: "+e)),console.log("Cached popup: "+e)}else console.warn("Popup node not found: "+e)}))},p.onDestroy=function(){this.popupComponents.forEach((function(n,e){n&&n.onPopupDestroy()}))},e}(r)).instance=null,m=e((P=w).prototype,"overlay",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(P.prototype,"pauseButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=P))||g));p._RF.pop()}}}));

System.register("chunks:///_virtual/victoryPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./basePopup.ts"],(function(e){var t,n,a,i,r,l,o,s,c,u,p,g,h,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,o=e.Label,s=e.Node,c=e.Sprite,u=e.Button,p=e.Vec3,g=e.tween,h=e.Tween},function(e){f=e.BasePopup}],execute:function(){var v,y,d,w,b,S,m,B,C,A,N,E,I;r._RF.push({},"5529e6jOhZOXIn3Hd8ylniS","victoryPopup",void 0);var O=l.ccclass,z=l.property;e("Victory",(v=O("Victory"),y=z(o),d=z([s]),w=z(c),b=z(c),S=z(u),v((C=t((B=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,a(t,"level",C,i(t)),a(t,"stars",A,i(t)),a(t,"ribbon",N,i(t)),a(t,"glow",E,i(t)),a(t,"continue",I,i(t)),t}n(t,e);var r=t.prototype;return r.onPopupShow=function(e){var t=this;this.resetAura(),this.popStar((function(){t.dropAllStars((function(){t.playAura(),t.glow.node.active=!0,t.repeatStar(),t.playJiggle(),t.playLevel((function(){}),e),t.playContinue()}))}))},r.playLevel=function(e,t){this.level.string="LEVEL "+t,this.level.node.active=!0,this.level.node.scale=new p(0,0,1),g(this.level.node).to(.2,{scale:new p(1,1,1)},{}).call((function(){e()})).start()},r.playContinue=function(e){this.continue.node.active=!0,this.continue.node.scale=new p(0,0,1),g(this.continue.node).to(.05,{scale:new p(1,1,1)},{}).start()},r.playAura=function(){this.stars.forEach((function(e){var t=e.getChildByName("MainAura");t&&(t.active=!0,console.log(t))}))},r.resetAura=function(){var e=this;this.level.string="",this.stars.forEach((function(t){var n=t.getChildByName("MainAura");n&&(n.active=!1),e.glow.node.active=!1;var a=t.getChildByName("Star"),i=null==a?void 0:a.getChildByName("Trail");i&&(i.active=!1)}))},r.playJiggle=function(e){g(this.ribbon.node).to(.08,{scale:new p(1.09,.98,1)}).to(.08,{scale:new p(.98,1.09,1)}).to(.08,{scale:new p(1,1,1)}).call((function(){console.log("fhyu"),e&&e()})).start()},r.popStar=function(e){var t=this;this.stars.forEach((function(e){var t=e.getChildByName("Star");t&&(h.stopAllByTarget(t),t.setScale(0,0,1),t.active=!0)}));this.stars.slice().reverse().forEach((function(n,a){var i=n.getChildByName("Star"),r=.3*(1-.2*a);i&&g(i).delay(r).parallel(g().to(.15,{angle:4}).to(.15,{angle:-4}).to(.15,{angle:0}),g().to(.6,{scale:new p(2,2,1)})).call((function(){a===t.stars.length-1&&e&&e()})).start()}))},r.dropAllStars=function(e){var t=this;this.stars.forEach((function(n,a){var i=n.getChildByName("Star"),r=null==i?void 0:i.getChildByName("Trail");r&&(r.active=!0),i&&g(i).to(.2,{scale:new p(1.1,1.1,1)}).call((function(){a===t.stars.length-1&&e&&e()})).start()}))},r.repeatStar=function(){this.stars.forEach((function(e,t){var n=e.getChildByName("Star");n&&0==t?g(n).parallel(g().to(1.4,{scale:new p(1.2,1.2,1)},{easing:"sineInOut"}).to(1.4,{scale:new p(1.3,1.3,1)},{easing:"sineInOut"}),g().to(1.7,{angle:25}).to(1.5,{angle:22})).repeatForever().start():n&&1==t?g(n).parallel(g().to(1.4,{scale:new p(1.2,1.2,1)},{easing:"sineInOut"}).to(1.4,{scale:new p(1.3,1.3,1)},{easing:"sineInOut"}),g().to(1.7,{angle:0}).to(1.5,{angle:0})).repeatForever().start():n&&2==t&&g(n).parallel(g().to(1.4,{scale:new p(1.2,1.2,1)},{easing:"sineInOut"}).to(1.4,{scale:new p(1.3,1.3,1)},{easing:"sineInOut"}),g().to(1.7,{angle:-25}).to(1.5,{angle:-22})).repeatForever().start()}))},t}(f)).prototype,"level",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=t(B.prototype,"stars",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=t(B.prototype,"ribbon",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(B.prototype,"glow",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(B.prototype,"continue",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=B))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/WinTurn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global.ts","./UImanager.ts","./BaseTurn.ts","./LevelLoader.ts"],(function(t){var n,e,i,a,o,r,s,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.find,a=t.tween},function(t){o=t.Popup},function(t){r=t.UImanager},function(t){s=t.BaseTurn},function(t){u=t.LevelLoader}],execute:function(){e._RF.push({},"a99a1BvIGtDzZ+e6hcZIVzB","WinTurn",void 0);t("WinTurn",function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var s=e.prototype;return s.onEnter=function(){var t=this;this.game.isgameOver=!0;var n=i("Canvas/Top/Timer");if(n){var e=n.getChildByName("clock");if(e){var s=e.getWorldPosition();this.game.starPool&&this.startStarAnimation(s,this.game.starPool)}}var c=this.game.time;a({time:c}).to(2,{time:0},{onUpdate:function(n){n&&(t.game.time=Math.max(0,n.time))}}).delay(.2).call((function(){r.showPopup(o.WINPOPUP,!0,u.getInstance().getCurrentLevelNumber())})).start()},s.startStarAnimation=function(t,n){for(var e=0;e<10;e++)a({}).delay(.2*e).call((function(){var e=n.getFirstItem();e&&e.winPut(t)})).start()},s.onExit=function(){},s.onUpdate=function(){},e}(s));e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});